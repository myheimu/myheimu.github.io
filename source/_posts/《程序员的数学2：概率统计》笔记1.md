---
title: 《程序员的数学2：概率统计》笔记1
date: 2019-04-28
updated: 2019-05-03
categories:
- 数学
tags:
- 读书笔记
- 概率论
permalink: probability-and-statistics-note-1
mathjax: true
---

* {% post_link probability-and-statistics-note-1 %}
* {% post_link probability-and-statistics-note-2 %}
* {% post_link probability-and-statistics-note-3 %}
----

这本书整体来说很不错，把重点放在用形象化、几何化的方法来描述概率相关问题，而相关的公式推导和习题也是限于引出结论而并非教科书般罗列。比如用“平行世界”、“协方差矩阵就是椭圆”来描述概率问题。

前五章主要描述了基础知识，整体比较简单；后三章是具体应用，有一定难度，但好在讲解集中于整体思路，易于理解。

中文版小错误不少，需要提前查看中文版勘误：http://www.ituring.com.cn/book/1254

如果觉得中文版推导和表述有些问题，也可以查看日文版《プログラミングのための確率統計》草稿：http://wiki.fdiary.net/lacs/?PSCS.PDF ，起码公式部分是能看懂的，我就发现了几个翻译过程中的公式错误，已经将勘误提交给中文版网站。

# 第1章 概率的定义

> A：根据我的调查，明年经济景气的概率是71.42857...%  
> B：你怎么能得到那么精确的数字？  
> A：模拟了7种设定后，其中5种情况下经济将会好转，所以5/7=0.7142857...  
> B：呃……槽点太多都不知道该怎么回答你了。总之我们先了解一下概率究竟是什么意思吧。

$$\Huge{概率即是面积}$$

**三扇门问题（蒙提霍尔问题）**

* “有三扇门，其中只有一扇是正确的门。挑战者选择一扇门打开，而主持人从剩下两扇门中的任选一扇错误的门打开（如果只有一扇错误，则打开它，如果有两扇错误，则随机选择一扇打开）。问挑战者是否要重选？重选和不重选概率如何？”
* 基础视角，容易得出错误答案
* 上升到“飞艇视角”：分设一堆游戏会场，都按照规则执行，各会场中发生情况的比例等于概率，根据最终各会场最终结果比例计算最终概率

将概率定义为：**满足下列条件的三元组 $(\Omega, \mathcal{F}, \rm{P})$ 称为概率空间，条件包括...**

从“人类视角”上升为“上帝视角”（类比前面的“飞艇视角”），类似平行世界思路：

* $\Omega$（样本空间）表示所有平行世界组成的集合，其面积为1，其中每个 $\omega$（样本）表示具体某个世界
* $\Omega$ 的子集 $A$（事件）的面积用 $\mathrm{P}(A)$ 表示，即代表概率
* 从上帝角度来看，随机变量只是函数 $f(ω)$，但从人类视角来看则是随机变量 $X(ω)$ ，可以同时存在多个随机变量 $X(ω),Y(ω),Z(ω)$
* 人类视角的概率分布 $\mathrm{P}(X=k)$，就是上帝视角的 $X(ω)=k$ 时 $ω$ 所占的区域面积

# 第2章 多个随机变量之间的关系

> A：根据我的调查，拥有游戏机的人中犯罪率高达50%以上。我们应该立法解决这一问题。  
> B：这个数字怎么会那么高？  
> A：最近的青少年犯罪中半数以上的嫌犯都拥有游戏机呀。  
> B：呃……这让我咋吐槽好呢？你能不能先不要考虑犯罪问题，调查一下现在青少年中游戏机的持有率再说？

对于两个离散值随机变量 $X$ 和 $Y$

**联合概率**
$$\mathrm{P}(X=a, Y=b)$$

**边缘概率**
$$\mathrm{P}(X=a) = \sum_b\mathrm{P}(X=a, Y=b)$$
$$\mathrm{P}(Y=b) = \sum_a\mathrm{P}(X=a, Y=b)$$

**条件概率**
$$\mathrm{P}(Y=b|X=a) = \frac{\mathrm{P}(X=a, Y=b)}{\mathrm{P}(X=a)}$$

**贝叶斯公式**
$$\mathrm{P}(X=a|Y=b) = \frac{\mathrm{P}(Y=b|X=a)\mathrm{P}(X=a)}{\mathrm{P}(Y=b)}$$

**独立性**

条件：对于随机变量所有取值，均有 $\mathrm{P}(X=a|Y=b)=\mathrm{P}(X=a|Y≠b)$，称之为随机变量独立

当具备独立性时，可以推导出一些公式，其中最重要的是“联合概率是边缘概率的乘积”：
$$\forall a,b\qquad  \mathrm{P}(X=a,Y=b) = \mathrm{P}(X=a) \mathrm{P}(Y=b)$$

三个及以上随机变量的独立性
* 各对事件相互独立不表示所有事件相互独立

# 第3章 离散值的概率分布
> A：有一份统计大家“每个月喝几次啤酒”的调查问卷，结果显示为月平均8次。另一份“每次喝几瓶啤酒”的调查问卷显示平均每次会喝1.5瓶。看来大家都不太诚实啊。  
> B：为什么这么说？  
> A：因为实际调查后，发现啤酒的人均月消耗量是15瓶，而根据调查问卷结果，8*1.5=12瓶，数字对不上。  
> B：呃……都不知道该怎么说你了。总之，你先去了解一下期望值的概念吧。

## 离散值随机变量
* 每一个事件的概率都大于等于0
* 所有概率之和为1

**二项分布**（binomial distribution）
* $n$ 次抛正面向上概率为 $p$ 的硬币，有 $k$ 次正面向上的概率
* $\mathrm{Bn}(n, p)$ 分布情况：$C_n^k p^k (1-p)^{n-k}\quad(k=0,1,2,\cdots,n)$

**期望值**，可以视为“上帝视角”下的所有平行世界平均值，形象化模拟为积雪体积
$$\mathrm{E}[X]=\sum_k k\mathrm{P}(X=k)$$
$$\mathrm{E}[g(X)]=\sum_k g(k)\mathrm{P}(X=k)$$

满足独立性的情况下，多随机变量乘积的期望值 = 各随机变量期望值的乘积
$$如果X与Y独立，\mathrm{E}[XY]=\mathrm{E}[X]\mathrm{E}[Y]$$

期望值可能存在不存在的情况，包括无穷大、无穷小和其他不收敛情况

**方差与标准差**

方差（此处并非传统课本上讲的方差的无偏估计版本，求平均时分母不为 $n-1$）

$$\mathrm{V}[X]\equiv\mathrm{E}[(X-\mu)^2]\qquad其中\mu\equiv\mathrm{E}[X]$$

标准差
$$\sigma\equiv\sqrt{\mathrm{V}[X]}$$

各随机变量独立时，和的方差等于方差的和
$$\mathrm{V}[X+Y] = \mathrm{V}[X] + \mathrm{V}[Y]$$

平方的期望值与方差
$$\mathrm{V}[X] = \mathrm{E}[X²] - \mathrm{E}[X]²$$
$$\mathrm{E}[X]^2 = \mu^2+\sigma^2\qquad其中\mu\equiv\mathrm{E}[X],\sigma^2\equiv\mathrm{V}[X]$$

**独立同分布**

当一批随机变量符合 1)每一个随机变量的边缘分布相同 2)任意相互独立，则为独立同分布（i.i.d.）

## 大数定律
独立同分布的一批随机变量的平均值 $Z\equiv(\sum_i X_i) / n$

计算得 $\mathrm{E}[Z]=\mu$，$\mathrm{V}[Z] = \sigma^2/n$

从“上帝视角”来看，每个随机变量在各个世界的平均值都是 $\mu$，所以每个世界的一批随机变量平均值的期望也是 $\mu$

当随机变量个数 $n$ 无限增加时，方差 $\mathrm{E}[Z]$ 趋近于0，这时 $Z$ 值也就收敛于 $\mu$

**条件期望**
$$\mathrm{E}[Y|X=a]\equiv\sum_b b\mathrm{P}(Y=b|X=a)$$

**条件方差**
$$\mathrm{V}[Y|X=a]\equiv\mathrm{E}[(Y-\mu(a))^2|X=a]\quad其中\mathrm{E}[Y|X=a]\equiv\mu(a)$$

## 最小二乘法
* 已知条件分布 $\mathrm{P}(Y=b|X=a)$，尝试编写函数 $g(X)$，让输入 $X$ 后的估计值 $\hat{Y}$ ，使得平方误差期望值 $\mathrm{E}[(Y-\hat{Y})^2]$ 尽量小。
* 答案就是应该使 $g(a) = \mathrm{E}[Y|X=a]$
* 上帝视角：铺平 $X$ 相同的区域的 $Y$ 值

# 第4章 连续值的概率分布
> A：我试着用正态分布去拟合数据，不过，用的这款统计软件好像有点问题啊。  
> B：怎么了？  
> A：它生成的正态分布图的高竟然超过了1,。概率怎么可能是1.7呢？概率为1就表示事件必然发生，不可能比这还要大呀。  
> B：嗯……依然是槽点太多不知道该说什么才好了。你还是重新学习一下概率密度函数的概念吧。

## 实数值随机变量

上帝视角：在一条色带上用油墨自左向右打印渐变色，最终消耗油墨总量为单位值，打印油墨的浓淡就是概率密度函数，而某一时刻累积消耗量就是累积分布函数

**累积分布函数**
$$F_X(a)\equiv\mathrm{P}(X\le a)$$

**概率密度函数**
$$f_X(x)\equiv F_X^\prime(x)=\frac{\mathrm{d}F_X(x)}{\mathrm{d}x}$$

一些性质
$$\mathrm{P}(a\le X\le b)=\int_a^b f_X(x)\mathrm{d}x$$
$$\int_{-\infty}^{\infty}f_X(x)\mathrm{d}x=1$$

任意一点的概率为0
$$\mathrm{P}(X=a) = 0$$

**均匀分布**：在一个区间$[\alpha,\beta]$范围内均匀分布
$$f_X(x)=\begin{cases}
\frac{1}{\beta-\alpha}&(\alpha\le x \le \beta)\\
0&(x<\alpha\ or\ x>\beta)
\end{cases}$$

**概率密度函数的变量变换**
* 随机变量增大n倍，会让对应部分概率密度函数缩小n倍
* 上帝视角：类似对打印好的渐变色带进行局部或整体的拉伸

**联合分布**

两个实数值随机变量 $X$ 与 $Y$ ，组成二元向量 $W\equiv(X,Y)$ 的概率分布，称为联合分布

$$\mathrm{P}(a\le X\le b,c\le Y\le d)=\int_c^d\int_a^bf_{XY}(x,y)\mathrm{d}x\mathrm{d}y$$
$$\int_{-\infty}^{\infty}\int_{-\infty}^{\infty}f_{XY}(x,y)\mathrm{d}x\mathrm{d}y = 1$$

上帝视角为：一个平面上用油墨进行打印，最终消耗油墨总量为1

**边缘概率**
$$f_X(x) =  \int_{-∞}^{∞} f_{X,Y}(x,y) \mathrm{d}y$$
$$f_Y(x) =  \int_{-∞}^{∞} f_{X,Y}(x,y)\mathrm{d}x$$
上帝视角：边缘概率密度，即按照x轴或y轴平行竖直截面面积

**条件分布**
$$f_{Y|X}(b|a) = \frac{f_{X,Y}(a,b)}{f_X(a)}$$
上帝视角：在 X=a 处进行截面，将截面内的分布扩大到累积量为1，即为条件分布

**贝叶斯公式**
$$f_{X|Y}(a|b)=\frac{f_{Y|X}(b|a)f_X(a)}{\int_{-\infty}^{\infty}f_{Y|X}(b|x)f_X(x)\mathrm{d}x}$$

**独立性**
$$\forall a,b:\qquad f_{Y|X}(b|a) = f_Y(b)$$
上式始终成立，才能称 $X$ 与 $Y$ 独立

**任意区域概率**

除了前面随机变量 $(X,Y)$ 形成的矩形区域，也可以是平面上任意区域形成的柱型体积，作为这一区域的概率

**均匀分布**

对于随机变量 $(X,Y)$ 构成平面上的某个特定区域 $C$（面积有限），可以形成均匀分布：
$$f_{X,Y}(x,y)=\begin{cases}
1/C的面积&((x,y)位于C内)\\
0&((x,y)位于C外)
\end{cases}$$

## 联合分布的变量变换

**横向拉伸**：$Z\equiv 2X, W\equiv Y$
$$f_{Z,W}(z,w) = \frac{1}{2}f_{X,Y}(z/2, w)$$
**纵向拉伸**：$Z≡X, W=1.5Y$
$$f_{Z,W}(z,w) = \frac{1}{1.5}f_{X,Y}(z, w/1.5)$$
**横向纵向同时拉伸**：$Z≡2X, W=1.5Y$
$$f_{Z,W}(z,w) = \frac{1}{3}f_{X,Y}(z/2, w/1.5)$$
**翻转**：$Z≡-2X, W=1.5Y$
$$f_{Z,W}(z,w) = \frac{1}{3}*f_{X,Y}(-z/2, w/1.5)$$
**斜向缩放**：$Z≡3X+Y, W≡X+2Y$

变换方程组为$X=(2Z-W)/5, Y=(3W-Z)/5$，计算出面积扩大到原来5倍
$$f_{Z,W}(z,w) = 1/5*f_{X,Y}((2z-w)/5, (3w-z)/5)$$

**线性变换**：$Z≡aX+bY, W≡cX+dY$

改写为$\begin{pmatrix}Z\\W\end{pmatrix}=A\begin{pmatrix}X\\Y\end{pmatrix},A\equiv\begin{pmatrix}a&b\\c&d\end{pmatrix}$

$$f_{Z,W}(z,w)=\frac{1}{|\det A|}f_{X,Y}(x,y)，其中\begin{pmatrix}x\\y\end{pmatrix}\equiv A^{-1}\begin{pmatrix}z\\w\end{pmatrix}$$

**具有曲率的变换**：$Z≡Xe^Y, W≡Y$
$$f_{Z,W}(z,w) = \frac{1}{e^w}f_{X,Y}(ze^{-w}, w)$$

**一一对应的非线性变换**：$Z≡g(X,Y), W≡h(X,Y)$

雅克比式（Jacobian）：
$$\frac{\partial(z,w)}{\partial(x,y)}\equiv\det\begin{pmatrix}
\frac{\partial z}{\partial x} & \frac{\partial z}{\partial y}\\
\frac{\partial w}{\partial x} & \frac{\partial w}{\partial y}\\
\end{pmatrix}$$
$$f_{Z,W}(z,w) = \frac{1}{|∂(z,w)/∂(x,y)|}f_{X,Y}(x,y)$$

也可以扩展到多变量情况

**期望值、方差与标准差**

与离散值定义一致，不过需要变换为积分形式（略）

## 正态分布
**标准正态分布（标准高斯分布）**
$$f(z) = \frac{1}{\sqrt{2\pi}}\exp(\frac{-z^2}{2})$$

期望 $\mathrm{E}[Z]=0$，方差 $\mathrm{V}[Z]=1$

通过高斯积分算得$\sqrt{2\pi}$，使用该系数使得积分为1；exp内部系数 $1/2$ 使得方差为1

**一般正态分布**

对标准正态分布进行缩放+平移：$X≡σZ+μ$

期望 $\mathrm{E}[X]=μ$，方差 $\mathrm{V}[X]=σ^2$

则称为 $X$ 符合期望为 $μ$，方差为 $σ^2$ 的正态分布，记作 $X\sim \mathrm{N}(μ, σ^2)$

如果随机变量 $X$ 的概率密度函数符合以下形式，则必然遵从正态分布：
$$f_X(x) = \Box\cdot\exp(x的二次式)\qquad（\Box为不含x的常量，二次式为ax²+bx+c形式）$$

独立的多个符合正态分布随机变量的线性加和，仍然是正态分布

**中心极限定理**

n个独立同分布i.i.d.的随机变量 $X_1,\cdots,X_n$，假设他们的期望值均为0，方差均为$σ^2$

简单累加 $X_1+\cdots+X_n$ 的方差 $nσ^2$ 随着 $n\to\infty$ 会趋向$\infty$

设 $W_n$ 如下，随着 $n\to\infty$，它将依分布收敛于 $\mathrm{N}(0,1)$：
$$W_n\equiv\frac{X_1+\cdots+X_n}{\sqrt{n}\sigma}$$

如果期望值不为0，则改写如下，仍然是收敛为 $\mathrm{N}(0,1)$ 标准正态分布：
$$W_n\equiv\frac{((X_1-\mu)+\cdots+(X_n-\mu)}{\sqrt{n}\sigma}$$

----
* {% post_link probability-and-statistics-note-1 %}
* {% post_link probability-and-statistics-note-2 %}
* {% post_link probability-and-statistics-note-3 %}