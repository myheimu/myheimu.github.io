---
title: 《程序员的数学3：线性代数》笔记2
date: 2019-05-18
updated: 2019-05-18
categories:
- 数学
tags:
- 读书笔记
- 线性代数
permalink: linear-algebra-note-2
mathjax: true
---

* {% post_link linear-algebra-note-1 %}
* {% post_link linear-algebra-note-2 %}

----
# 第3章 计算机上的计算（1）——LU分解
数值计算相比纸笔演算，有独特的限制：

- 数值精度只有有限位
- 尽量减少运算量和内存消耗

## LU分解
### LU分解定义
将给定矩阵 A 表示成一个下三角矩阵 L 和上三角矩阵 U 的乘积，称为**LU分解**（也有叫LR分解），习惯上 L 的对角元素都是1（另外还有LDU分解，即分解为对角元素都是1的下三角矩阵L、对角矩阵D、对角元素都是1的上三角矩阵U）：

$$A=\begin{pmatrix}1&0&0&0&0\\■&1&0&0&0\\■&■&1&0&0\\■&■&■&1&0\\■&■&■&■&1\end{pmatrix}
\begin{pmatrix}■&■&■&■&■\\0&■&■&■&■\\0&0&■&■&■\\0&0&0&■&■\\0&0&0&0&■\end{pmatrix}\equiv LU$$

对于非方阵 B 和 C，则希望形式为：
$$B=\begin{pmatrix}1&0&0\\■&1&0\\■&■&1\\■&■&■\\■&■&■\end{pmatrix}
\begin{pmatrix}■&■&■\\0&■&■\\0&0&■\end{pmatrix}$$

$$C=\begin{pmatrix}1&0&0\\■&1&0\\■&■&1\end{pmatrix}
\begin{pmatrix}■&■&■&■&■\\0&■&■&■&■\\0&0&■&■&■\end{pmatrix}$$

LU分解可行性（略）

LU分解运算量，对n阶方阵进行LU分解计算量对比如下：

| 方法  | LU分解 | 消元法解线性方程组 | Gauss-Jordan法解线性方程组 | 矩阵求逆 |
| ------ | ------ | ------ | ------ | ------ |
| 除法 | $n$ | $n$ | $n$ | $n$ |
| 乘法 | $n^3/3$ | $n^3/3$ | $n^3/2$ | $n^3$ |
| 减法 | $n^3/3$ | $n^3/3$ | $n^3/2$ | $n^3$ |

## LU分解步骤1：一般情况
对于 $m×n$ 的矩阵 $A=(a_{ij})$，令 $s=\min(m,n)$，考虑进行LU分解（$m×s$阶的下三角矩阵，$s×n$阶的上三角矩阵），对L、U矩阵进行分块：
$$L=(\boldsymbol{l}_1,\cdots,\boldsymbol{l}_s),\quad U=\begin{pmatrix}\boldsymbol{u}_1^T\\\vdots\\\boldsymbol{u}_s^T\end{pmatrix}$$

可根据分块矩阵乘法公式得到：
$$A=\boldsymbol{l}_1\boldsymbol{u}_1^T+\cdots+\boldsymbol{l}_s\boldsymbol{u}_s^T$$

记第一步计算为 $A\equiv A(1)=(a_{ij}(1))$，令：
$$\boldsymbol{l}_1=\frac{1}{a_{11}(1)}\begin{pmatrix}a_{11}(1)\\\vdots\\a_{m1}(1)\end{pmatrix}, \quad \boldsymbol{u}_1^T=(a_{11}(1),\cdots,a_{1n}(1))$$

则可以算得：
$$A(1)-\boldsymbol{l}_1\boldsymbol{u}_1^T=\left(\begin{array}{c|ccc}
0&0&&\cdots&&0\\\hline 0\\\vdots&&&A(2)\\0\\
\end{array}\right)$$

从而获得第二步，也就是缩小了的矩阵 $A(2)=(a_{ij}(2))$ 分解，依次递归执行下去即可，例如

$$\boldsymbol{l}(2)=\frac{1}{a_{11}(2)}\begin{pmatrix}a_{11}(2)\\\vdots\\a_{m'1}(2)\end{pmatrix}, \quad \boldsymbol{u}(2)^T=(a_{11}(2),\cdots,a_{1n'}(2))$$

$$\boldsymbol{l}_2=\begin{pmatrix}0\\\hline\\\boldsymbol{l}(2)\\\end{pmatrix},\quad \boldsymbol{u}_2^T=\left(\begin{array}{c|c}0&\boldsymbol{u}(2)^T\end{array}\right)$$

$$\left(\begin{array}{c|ccc}0&0&&\cdots&&0\\\hline 0\\\vdots&&&A(2)\\0\\\end{array}\right)
-\boldsymbol{l}_2\boldsymbol{u}_2^T=
\left(\begin{array}{cc|ccc}0&0&0&\cdots&0\\0&0&0&\cdots&0\\\hline 0&0\\\vdots&\vdots&&A(3)\\0&0\\\end{array}\right)$$

最终可以算得 $A=\boldsymbol{l}_1\boldsymbol{u}_1^T+\cdots+\boldsymbol{l}_s\boldsymbol{u}_s^T+O$ 的全部数字

在实际开发之中，一方面可以把 L 和 U 矩阵合并存放在一起（L的对角线部分不需要存储），一方面可以共用原矩阵 A 的空间，因为所需计算不会依赖于已经被覆盖的元素，如下图中▲代表处理中的原矩阵，□代表算出来的L，■代表算出来的U

\begin{pmatrix}■&■&■&■&■\\□&■&■&■&■\\□&□&▲&▲&▲\\□&□&▲&▲&▲\\□&□&▲&▲&▲\end{pmatrix}

## LU分解求行列式值
基于行列式形式，以及下三角和上三角矩阵行列式都是对角元素乘积的性质，可得：

$$\det A = \det(LU) = \det L \det U=\det U=U的对角元素乘积$$

## LU分解求线性方程组
将寻找满足 $A\boldsymbol{x}=\boldsymbol{y}$ 的向量 $\boldsymbol{x}$，转变为：

- 寻找满足 $L\boldsymbol{z}=\boldsymbol{y}$ 的 $\boldsymbol{z}$
- 寻找满足 $U\boldsymbol{x}=\boldsymbol{z}$ 的 $\boldsymbol{x}$

第一步，可以轻松通过依次带入，依次算出 $z_1,z_2,\cdots,z_s$：
$$\begin{pmatrix} 1\\钱&1\\孙&郑&1\\李&王&卫&1 \end{pmatrix}
\begin{pmatrix}z_1\\z_2\\z_3\\z_4\end{pmatrix}=
\begin{pmatrix}子\\丑\\寅\\卯\end{pmatrix}$$

第二步，通过同样操作，也可以依次算出 $x_s,x_{s-1},\cdots,x_1$：
$$\begin{pmatrix} 赵&钱&孙&李\\&吴&郑&王\\&&楚&魏\\&&&杨 \end{pmatrix}
\begin{pmatrix}x_1\\x_2\\x_3\\x_4\end{pmatrix}=
\begin{pmatrix}z_1\\z_2\\z_3\\z_4\end{pmatrix}$$

其实计算过程与消元法本质上是一致的，只不过消元法是通过初等变换直接解出 $L\boldsymbol{z}=\boldsymbol{y}$，并没有中途算出 $L$

## LU分解求逆矩阵
类似前面求逆矩阵方法，通过 $AX=I$ 分拆为多个线性方程组任务 $A(\boldsymbol{x}_1,\cdots,\boldsymbol{x}_n)=(\boldsymbol{e}_1,\cdots,\boldsymbol{e}_n)$，自然可以算得

一次LU分解，可以用于多次线性方程组计算，因此大大降低了运算量

## LU分解步骤2：意外情况
当第k步时遇到当前对角线上主元已经是0时，则遇到了意外，因为无法算倒数，即 $a_{11}(k)=0$，此时需要从其他行任意选择一个对应位置非0元素作为替换主元

$$A=\boldsymbol{l}_1\boldsymbol{u}_1^T+\left(\begin{array}{c|cc}
0&0&0&0\\\hline
0&\boxed{0}&周&冯\\
0&钱&吴&陈\\
0&孙&郑&褚\\
\end{array}\right)$$

$$A'=\boldsymbol{l}'_1\boldsymbol{u}_1^T+\left(\begin{array}{c|cc}
0&0&0&0\\\hline
0&\boxed{孙}&郑&褚\\
0&钱&吴&陈\\
0&\boxed{0}&周&冯\\
\end{array}\right)$$

安装初等变换记法，有 $A'=S_{2,4}A$，则 $A=S_{2,4}^{-1}LU=S_{2,4}LU$，由于可以多次变换，所以最终：
$$A=PLU\\P=S_{*,*}S_{*,*}\cdots S_{*,*}$$

（其中矩阵P，每一行中恰好有一个1，每一列中也恰好有一个1，其他元素为0，称之为**置换矩阵**）

对于计算行列式，则需要看 $\det P$，也就是 $S_{*,*}$ 的个数为偶数时不变号，为奇数时变号

对于线性方程组，由于 $P^{-1}=P^T$，则计算 $LU\boldsymbol{x}=\boldsymbol{y}'\quad(\boldsymbol{y}'\equiv P^T \boldsymbol{y})$

更极端的情况下，其他行对应位置也全部为0，则需要允许列交换：
$$A=PLUP'\quad(P,P'均为置换矩阵)$$

如果其他行、其他列都为0，也就分解完毕了

但从实践来说，可逆矩阵一定可以分解成 $A=PLU$ 形式，所以通常遇到必须列交换或提前分解完毕时，已经可以确定矩阵不可逆，无需后续操作了

----
* {% post_link linear-algebra-note-1 %}
* {% post_link linear-algebra-note-2 %}
