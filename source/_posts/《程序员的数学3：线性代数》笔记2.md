---
title: 《程序员的数学3：线性代数》笔记2
date: 2019-05-18
updated: 2019-05-19
categories:
- 数学
tags:
- 读书笔记
- 线性代数
permalink: linear-algebra-note-2
mathjax: true
---

* {% post_link linear-algebra-note-1 %}
* {% post_link linear-algebra-note-2 %}
* {% post_link linear-algebra-note-3 %}
* {% post_link linear-algebra-note-4 %}

----

# 第2章 秩、逆矩阵、线性方程组
## 问题设定：逆问题
现实之中只有线性映射才能使用矩阵来表示，当然近似线性也可以采用矩阵来近似

已知原因 $\boldsymbol{x}$ 去预测结果 $\boldsymbol{y}$，称之为**顺问题**

由已知结果 $\boldsymbol{y}$ 去推测原因 $\boldsymbol{x}$ 称之为**逆问题**

现实之中还应该考虑噪声，但暂且无视

PS：以下所说**良性问题**和**恶性问题**并非严格数学概念，只是对矩阵本身性质的一种便于理解描述，与后文中数值分析的**良态**和**病态**并无关系

## 良性问题（可逆矩阵）
存在逆矩阵的方阵，称之为**可逆矩阵**、**非奇异矩阵**、**正则方阵**，反之则称之为**不可逆矩阵**、**奇异矩阵**、**非正则矩阵**

$$\boldsymbol{x}=A^{-1}\boldsymbol{y}$$

### 线性方程组解法
构成 $A\boldsymbol{x}=\boldsymbol{y}$ 的多元一次方程组，通过已知的 $A$ 和 $\boldsymbol{y}$ 来求解 $\boldsymbol{x}$

**消元法**（略）

可以采用分块矩阵来表示消元法的过程，即把公式：
$$\left(\begin{array}{c|c} A&\boldsymbol{y}\end{array}\right)
\begin{pmatrix}\boldsymbol{x}\\\hline\\-1\end{pmatrix}=\boldsymbol{o}$$

通过消元变换为
$$\left(\begin{array}{c|c} I&\boldsymbol{s}\end{array}\right)
\begin{pmatrix}\boldsymbol{x}\\\hline\\-1\end{pmatrix}=\boldsymbol{o}$$

**Gauss-Jordan法**（略）
依旧是把 $(A\ |\ \boldsymbol{y})$ 变换为 $(I\ |\ \boldsymbol{s})$ 的过程

整体方法与消元法类似，但略有区别：
* GJ法是一次性从左向右，把每一列都变成只有对角线上元素为1，其他元素为0
* 消元法是先从左向右，把对角线上元素变成1，而左下三角区为0，然后再从下往上，把右上三角区变为0

PS：如果遇到对角线为0的情况，需要切换主元

### 逆矩阵计算方法（适合笔算的方法）
对于n阶方阵$A$，满足 $AX=I$ 的方阵 $X$ 就是其逆矩阵，可以将 $X$ 分块成列向量 $X=(\boldsymbol{x}_1,\cdots,\boldsymbol{x}_n)$，将单位矩阵分块为 $I=(\boldsymbol{e}_1,\cdots,\boldsymbol{e}_n)$，则有：
$$A\boldsymbol{x}_i=\boldsymbol{e}_i$$

也就是做变换
$$(A|\boldsymbol{e}_i) \rightarrow (I|\boldsymbol{s}_i)$$

其中 $\boldsymbol{s}_i$ 就是要求解的 $\boldsymbol{x}_i$，则整体可以拼成：
$$(A|I)\rightarrow(I|X)$$

因此采用Gauss-Jordan法，对 $(A|I)$ 进行变换，最终得到 $(I|X)$

### 初等变换
对于以上笔算法的步骤，可以总结为三种操作：

* 将某行乘以 $c$
* 将某行的 $c$ 倍加到另一行上
* 交换两行

实际上它们都可以被表示为乘上一个矩阵

对于3×4矩阵 $A$，例如：
$$A=\begin{pmatrix}2&3&3&9\\3&4&2&9\\-2&-2&3&2\end{pmatrix}$$

* 将第3行乘以5 -> 左乘上“将单位矩阵的(3,3)元素替换为5的矩阵$Q_3(5)$”
$$Q_3(5)=\begin{pmatrix}1&0&0\\0&1&0\\0&0&\boxed{\mathit{5}}\end{pmatrix}$$

$$Q_3(5)A=\begin{pmatrix}2&3&3&9\\3&4&2&9\\\boxed{\mathit{-10}}&\boxed{\mathit{-10}}&\boxed{\mathit{15}}&\boxed{\mathit{10}}\end{pmatrix}$$

* 将第1行乘以10加到第2行上 -> 左乘上“将单位矩阵的(2,1)元素替换成10的矩阵 $R_{2,1}(10)$”
$$R_{2,1}(10)=\begin{pmatrix}1&0&0\\\boxed{\mathit{10}}&1&0\\0&0&1\end{pmatrix}$$

$$R_{2,1}(10)A=\begin{pmatrix}2&3&3&9\\\boxed{\mathit{23}}&\boxed{\mathit{34}}&\boxed{\mathit{32}}&\boxed{\mathit{99}}\\-2&-2&3&2\end{pmatrix}$$

* 交换第1行和第3行 -> 左乘上“交换单位矩阵第1行和第3行得到的矩阵 $S_{1,3}$”
$$S_{1,3}=\begin{pmatrix}0&0&\boxed{\mathit{1}}\\0&1&0\\\boxed{\mathit{1}}&0&0\end{pmatrix}$$

$$S_{1,3}A=\begin{pmatrix}\boxed{\mathit{-2}}&\boxed{\mathit{-2}}&\boxed{\mathit{3}}&\boxed{\mathit{2}}\\3&4&2&9\\\boxed{\mathit{2}}&\boxed{\mathit{3}}&\boxed{\mathit{3}}&\boxed{\mathit{9}}\end{pmatrix}$$

以上这些操作称之为 **初等（行）变换**

那么求解线性方程组和求逆矩阵，都可以用左乘上一堆初等变换操作来表示

可以证明，只需要以上三类变形，即可以完成所有可解的线性方程求解和所有可逆矩阵的求逆

## 恶性问题
### 恶性问题举例
#### 线索不足情况（矮矩阵、核）
当结果 $\boldsymbol{y}$ 的维度小于原因 $\boldsymbol{x}$ 的维度时，A为矮矩阵，例如：
$$\begin{pmatrix}*\\*\end{pmatrix}=\begin{pmatrix}*&*&*\\*&*&*\end{pmatrix}\begin{pmatrix}*\\*\\*\end{pmatrix}\\\boldsymbol{y}=A\boldsymbol{x}$$

形象化来说，相当于从高维空间向低维空间的映射，进行了“压缩扁平化”。那么求其逆问题时，则无法完全恢复原因 $\boldsymbol{x}$ 的位置点，只能确定其所属的范围（损失1维，则是直线，损失2维，则是平面）

记满足 $A\boldsymbol{x}=\boldsymbol{o}$ 的 $\boldsymbol{x}$ 的集合称为 $A$ 的**核**（Kernel），记为 $\mathrm{Ker}\ A$（也有人称之为零空间 null space）

A的核，也就对应了可还原的范围，Ker A为0，则是非“压缩扁平化”，Ker A为1，则是直线，Ker A为2，则是平面

#### 线索过多情况（长矩阵，像）
当结果 $\boldsymbol{y}$ 的维度大于原因 $\boldsymbol{x}$ 的维度时，A为长矩阵，例如：
$$\begin{pmatrix}*\\*\\*\end{pmatrix}=\begin{pmatrix}*&*\\*&*\\*&*\end{pmatrix}\begin{pmatrix}*\\*\end{pmatrix}\\\boldsymbol{y}=A\boldsymbol{x}$$

对于给定的 $A$，针对各类 $\boldsymbol{x}$ 进行转换，所构成的集合称之为 $A$ 的**像**（Image），记为 $\mathrm{Im}\ A$

#### 奇异矩阵
虽然 $A$ 是方阵，但进行了“压缩扁平化”，导致无法通过结果 $\boldsymbol{y}$ 找到唯一的原因 $\boldsymbol{x}$，或者压根找不到原因 $\boldsymbol{x}$

### 恶劣程度：核与像
如果对于相同的结果 $\boldsymbol{y}$，它的原因 $\boldsymbol{x}$ 是唯一的，那么叫做**单射**（也叫一对一映射、一一映射）

如果任何结果 $\boldsymbol{y}$ 都可以找到它的原因 $\boldsymbol{x}$，那么叫做**满射**（也叫映上的映射）

同时满足单射和满射，则称之为**双射**（也叫一对一映上的映射）

$$\mathrm{Ker}\ A\ 仅包括原点\boldsymbol{o}\Leftrightarrow 映射为单射$$

$$\mathrm{Im}\ A\ 与目标空间全体一致\Leftrightarrow 映射为满射$$

### 维度定理（秩-零化度定理）
对于 $m\times n$ 的矩阵 $A$，有：
$$\dim \mathrm{Ker}\ A+\dim \mathrm{Im}\ A = n$$

形象化理解，A是从n维空间向m空间的映射，那么从原本n维中，压缩掉Ker A对应的维度，则剩下的也就是Im A的维度

### 用式子表示“压缩扁平化”变换（线性无关、线性相关）
压缩扁平化，说白了就是对于不同的原因 $\boldsymbol{x}$ 会被矩阵 $A$ 映射到相同的结果 $\boldsymbol{y}$，此时称矩阵 $A$ 的各列向量 $\boldsymbol{a}_1,\cdots,\boldsymbol{a}_n$ 线性相关，反之则是线性无关

### 秩
将映射的像 $\mathrm{Im}\ A$ 的维度 $\dim\mathrm{Im}\ A$ 命名为矩阵A的**秩**（rank）

$\mathrm{rank}\ A=n$，即秩与原空间（定义域）的维数相等时，等价于A是单射

$\mathrm{rank}\ A=m$，即秩与目标空间（值域）的维数相等时，等价于A是满射

对于 $m\times n$ 矩阵 $A$，有以下性质：
$$\mathrm{rank}\ A\le m,\ \mathrm{rank}\ A\le n$$

对于可逆矩阵 $P$ 和 $Q$：
$$\mathrm{rank}(PA)=\mathrm{rank}\ A\\\mathrm{rank}(AQ)=\mathrm{rank}\ A$$

对于一般矩阵 $A$ 和 $B$，有：
$$\mathrm{rank}(BA)\le \mathrm{rank}\ A,\ \mathrm{rank}(BA)\le \mathrm{rank}\ B$$

$$\mathrm{rank}(A+B)\le \mathrm{rank}\ A + \mathrm{rank}\ B$$

$$\mathrm{rank}(AB)+\mathrm{rank}(BC)\le \mathrm{rank}(ABC) + \mathrm{rank}\ B$$

**瓶颈型分解**
对于秩为r的矩阵A，可以分解成两个“瘦矩阵”的乘积，即宽为r的矩阵B和高为r的矩阵C的乘积（一定可以分解，但分解方法有多种）

转置矩阵的秩不变，复矩阵也同理：
$$\mathrm{rank}\ A^T=\mathrm{rank}\ A\\\mathrm{rank}\ A^*=\mathrm{rank}\ A$$

### 秩的求解方法1：悉心观察
对于 $m\times n$ 的矩阵 $A$，对于不同的 $n$ 维向量 $\boldsymbol{x}$ 时 $\boldsymbol{y}=A\boldsymbol{x}$ 的活动范围，即 $\mathrm{Im}\ A$，可以对 $A$ 按列分块变为：
$$\boldsymbol{y}=x_1\boldsymbol{a}_1+\cdots+x_n\boldsymbol{a}_n$$

即“由向量 $\boldsymbol{a}_1,\cdots,\boldsymbol{a}_n$ **张成**的线性子空间”，记为：
$$\mathrm{span} \{ \boldsymbol{a}_1,\cdots,\boldsymbol{a}_n \}$$

则有 $\mathrm{Im}\ A=\mathrm{span} \{ \boldsymbol{a}_1,\cdots,\boldsymbol{a}_n \}$，而 $\mathrm{rank}\ A$ 也就是这个线性子空间的维数

如果能够找到最少的“基础素材” $\boldsymbol{b}_1,\cdots,\boldsymbol{b}_r$ 来表示出上述n个向量，则r就是这个线性子控件的维数，也就是 $\mathrm{rank}\ A$

此时就可以通过观察，寻找最少的“基础素材”，思路主要满足以下几条：
* 可以用所有的 $\boldsymbol{b}_i$ 表示出所有的 $\boldsymbol{a}_i$
* 所有的 $\boldsymbol{b}_i$ 属于 $\mathrm{span} \{ \boldsymbol{a}_1,\cdots,\boldsymbol{a}_n \}$
* 所有的 $\boldsymbol{b}_i$ 线性无关

### 秩的求解方法2：笔算
引入**初等列变换**，也就是在原矩阵基础上，右乘上初等变换矩阵，包括：

* 在某列上乘以c
* 把某列的c倍加到另一列上
* 交换两列

初等变换矩阵均是可逆的，而矩阵乘上可逆矩阵之后，秩不会发生变化。所以可以进行初等变换（左乘进行行变换，右乘进行列变换），从而变成可以轻松计算秩的矩阵

最终变换为对角线（尽管可能非方阵）上尽量是1（如果为0则换主元），而其他元素都是0。此时1的个数就是秩

最终形成矩阵形状如下，其中左上角 $I$ 宽度和高度即为 $\mathrm{Im}\ A$ 维数，而右上角 $O$ 宽度即为 $\mathrm{Ker}\ A$ 维数
$$\left(\begin{array}{ccc|cc} &&&&\\&I&&&O\\\\\hline \\&O&&&O \end{array}\right)$$

## 良恶问题的判断
仅讨论方阵 $A$ 是否是良性问题，即逆矩阵 $A^{-1}$ 是否存在。以下命题全部等价（他们的相反命题也全部等价）：

- 对于任何n维向量 $\boldsymbol{y}$，使得 $\boldsymbol{y}=A\boldsymbol{x}$ 成立的 $\boldsymbol{x}$ 都只有一个
- $A$ 是可逆矩阵
- $A$ 对应的映射不是“压缩扁平化”映射
    - $A$ 对应的映射是单射
- 使得 $A\boldsymbol{x}=\boldsymbol{o}$ 成立的仅有 $\boldsymbol{x}=\boldsymbol{o}$ 一个值
    - $\mathrm{Ker}\ A$ 仅包括原点 $\boldsymbol{o}$ 一点
        - $\dim \mathrm{Ker}\ A=0$
- $A$ 的列向量线性无关
- 在 $A$ 的映射作用下，目标空间可以全部被覆盖到
    - $A$ 对应的映射是满射
        - $\mathrm{Im}\ A$ 是n维空间全体
- $\mathrm{rank}\ A=\dim\mathrm{Im}\ A=n$
- $\det A\ne0$
- $A$ 不含0特征值
- 以上全部命题替换为 $A^T$ 得到的命题

## 针对恶性问题的对策
针对恶性问题，尽量做到：如果没有解，给出无解的回答；如果有多个解，给出所有解

对于给定的矩阵 $A$ 和向量 $\boldsymbol{y}$，方程 $A\boldsymbol{x}=\boldsymbol{y}$ 存在解的充分必要条件是，$\boldsymbol{y}$ 属于 $\mathrm{Im}\ A$

只要找到一个解 $\boldsymbol{x}_0$的前提下，对于属于 $\mathrm{Ker}\ A$ 的任何向量 $\boldsymbol{z}$，那么 $\boldsymbol{x}_0+\boldsymbol{z}$ 也是方程的解

具体方法为：

 - 先获得一个**特解** $\boldsymbol{x}_0$
 - 针对**齐次方程** $A\boldsymbol{z}=\boldsymbol{o}$ 求出**通解**，即根据 $\mathrm{Ker}\ A$的基底 $(\boldsymbol{z}_1,\cdots,\boldsymbol{z}_k)$ 得到通解
$$\boldsymbol{z}=c_1\boldsymbol{z}_1+\cdots+c_k\boldsymbol{z}_k$$

 - 特解+通解，即为所有的解

### 笔算算法

线索过剩情况，可能无解，对$(A|\boldsymbol{y})\left(\frac{\boldsymbol{x}}{-1}\right)=\boldsymbol{o}$ 中的矩阵 $(A|\boldsymbol{y})$ 进行初等行变换，从而变成如下形式：
$$\left(\begin{array}{ccc|c}
1&&&*\\&\ddots&&\vdots\\&&1&*\\
&&&\boxed{*}\\&&&\vdots\\&&&\boxed{*}\\
\end{array}\right)\qquad(空白处均为0)$$

其中 $\boxed{*}$ 部分只要有任一不为0，则形成矛盾，无解；反之有单解

线索不足情况下，可能有多解，同样对矩阵 $(A|\boldsymbol{y})$ 进行初等行变换，从而变成：
$$\left(\begin{array}{ccccc|c}
1&&&赵&李&子\\
&1&&钱&周&丑\\
&&1&孙&吴&寅\\
\end{array}\right)\qquad(空白处均为0)$$

则解为：
$$\begin{pmatrix}x_1\\x_2\\x_3\\x_4\\x_5\end{pmatrix}=
\begin{pmatrix}-赵c_1-李c_2+子\\-钱c_1-周c_2+丑\\-孙c_1-吴c_2+寅\\c_1\\c_2\end{pmatrix}
\qquad（c_1,c_2为任意值）$$

如果初等行变换过程中遇到对角线上为0情况，则需要进行列交换更换主元，但需要注意同时更换对应 $x_i$

$$\left(\begin{array}{cccc|c}1&0&5&4&4\\0&1&2&3&2\\0&0&0&3&6\end{array}\right)
\begin{pmatrix}x_1\\x_2\\x_3\\x_4\\\hline\\-1\end{pmatrix}=\boldsymbol{o}\longrightarrow
\left(\begin{array}{cccc|c}1&0&\boxed{\mathit{4}}&\boxed{\mathit{5}}&4\\0&1&\boxed{\mathit{3}}&\boxed{\mathit{2}}&2\\0&0&\boxed{\mathit{3}}&\boxed{\mathit{0}}&6\end{array}\right)
\begin{pmatrix}x_1\\x_2\\\boxed{\mathit{x_4}}\\\boxed{\mathit{x_3}}\\\hline\\-1\end{pmatrix}=\boldsymbol{o}$$

更严重的情况，可能遇到对角线上为0，且其他列候选位置也都为0情况：
$$\left(\begin{array}{cccccc|c}
1&&&*&\cdots&*&*\\&\ddots&&\vdots&\ddots&\vdots&\vdots\\&&1&*&\cdots&*&*\\
&&&&&&\boxed{*}\\&&&&&&\vdots\\&&&&&&\boxed{*}\\
\end{array}\right)\qquad(空白处均为0)$$

则如果其中 $\boxed{*}$ 位置全都为0，则有解；反之无解

### 笔算法总结
前文所有笔算法，具有一定通用性，均为期望将矩阵变换为：
$$\left(\begin{array}{cccccc}
1&&&*&\cdots&*\\&\ddots&&\vdots&\ddots&\vdots\\&&1&*&\cdots&*\\
\end{array}\right)\qquad(*处均为数，空白处均为0)$$

- 行列式：对 $A$ 进行**初等行/列变换**得到类似上式（即单位矩阵），将变换之中的产生的行列式数值记录下来（行乘的倍数、行交换变号、某行加另外一行倍数不变），反推即可。如果得不到单位矩阵则为0
- 逆矩阵：对 $(A|I)$ 进行**初等行变换**得到类似上式，如果能构成 $(I|X)$，则 $X=A^{-1}$，否则不存在
- 秩：进行**初等行/列变换**得到类似上式，对角线上1的个数记为秩
- 线性方程组：对于 $A\boldsymbol{x}=\boldsymbol{y}$，对分块矩阵 $(A|\boldsymbol{y})$ 进行**初等行/列变换**得到类似上式（但列交换不允许涉及 $\boldsymbol{y}$ 部分，列交换需要记录对 $x_i$ 的交换），最后写成线性方程组即可求解

### 最小二乘法
前文是基于“无解则回答无解；有解则给出所有解”

而最小二乘法可以做到“无解给出最接近的解，有解给出最合理的解”

## 现实之中的恶性问题
现实之中可能大量存在接近奇异的可逆矩阵，问题关键在于结果的噪声信息在还原过程中，会被大幅度放大

需要同时兼顾还原的偏差（例如$\|A\boldsymbol{x}-\boldsymbol{y}\|$）和原因的合理性（例如 $\|\boldsymbol{x}\|$）

则问题转换为求解 $\|A\boldsymbol{x}-\boldsymbol{y}\|^2+\alpha\|\boldsymbol{x}\|$ 最小的 $\boldsymbol{x}$，可以推导出 $\boldsymbol{x}=(A^TA+\alpha I)^{-1}A^T\boldsymbol{y}$（提克洛夫规范化）


# 第3章 计算机上的计算（1）——LU分解
数值计算相比纸笔演算，有独特的限制：

- 数值精度只有有限位
- 尽量减少运算量和内存消耗

## LU分解
### LU分解定义
将给定矩阵 A 表示成一个下三角矩阵 L 和上三角矩阵 U 的乘积，称为**LU分解**（也有叫LR分解），习惯上 L 的对角元素都是1（另外还有LDU分解，即分解为对角元素都是1的下三角矩阵L、对角矩阵D、对角元素都是1的上三角矩阵U）：

$$A=\begin{pmatrix}1&0&0&0&0\\■&1&0&0&0\\■&■&1&0&0\\■&■&■&1&0\\■&■&■&■&1\end{pmatrix}
\begin{pmatrix}■&■&■&■&■\\0&■&■&■&■\\0&0&■&■&■\\0&0&0&■&■\\0&0&0&0&■\end{pmatrix}\equiv LU$$

对于非方阵 B 和 C，则希望形式为：
$$B=\begin{pmatrix}1&0&0\\■&1&0\\■&■&1\\■&■&■\\■&■&■\end{pmatrix}
\begin{pmatrix}■&■&■\\0&■&■\\0&0&■\end{pmatrix}$$

$$C=\begin{pmatrix}1&0&0\\■&1&0\\■&■&1\end{pmatrix}
\begin{pmatrix}■&■&■&■&■\\0&■&■&■&■\\0&0&■&■&■\end{pmatrix}$$

LU分解可行性（略）

LU分解运算量，对n阶方阵进行LU分解计算量对比如下：

| 方法  | LU分解 | 消元法解线性方程组 | Gauss-Jordan法解线性方程组 | 矩阵求逆 |
| ------ | ------ | ------ | ------ | ------ |
| 除法 | $n$ | $n$ | $n$ | $n$ |
| 乘法 | $n^3/3$ | $n^3/3$ | $n^3/2$ | $n^3$ |
| 减法 | $n^3/3$ | $n^3/3$ | $n^3/2$ | $n^3$ |

## LU分解步骤1：一般情况
对于 $m×n$ 的矩阵 $A=(a_{ij})$，令 $s=\min(m,n)$，考虑进行LU分解（$m×s$阶的下三角矩阵，$s×n$阶的上三角矩阵），对L、U矩阵进行分块：
$$L=(\boldsymbol{l}_1,\cdots,\boldsymbol{l}_s),\quad U=\begin{pmatrix}\boldsymbol{u}_1^T\\\vdots\\\boldsymbol{u}_s^T\end{pmatrix}$$

可根据分块矩阵乘法公式得到：
$$A=\boldsymbol{l}_1\boldsymbol{u}_1^T+\cdots+\boldsymbol{l}_s\boldsymbol{u}_s^T$$

记第一步计算为 $A\equiv A(1)=(a_{ij}(1))$，令：
$$\boldsymbol{l}_1=\frac{1}{a_{11}(1)}\begin{pmatrix}a_{11}(1)\\\vdots\\a_{m1}(1)\end{pmatrix}, \quad \boldsymbol{u}_1^T=(a_{11}(1),\cdots,a_{1n}(1))$$

则可以算得：
$$A(1)-\boldsymbol{l}_1\boldsymbol{u}_1^T=\left(\begin{array}{c|ccc}
0&0&&\cdots&&0\\\hline 0\\\vdots&&&A(2)\\0\\
\end{array}\right)$$

从而获得第二步，也就是缩小了的矩阵 $A(2)=(a_{ij}(2))$ 分解，依次递归执行下去即可，例如

$$\boldsymbol{l}(2)=\frac{1}{a_{11}(2)}\begin{pmatrix}a_{11}(2)\\\vdots\\a_{m'1}(2)\end{pmatrix}, \quad \boldsymbol{u}(2)^T=(a_{11}(2),\cdots,a_{1n'}(2))$$

$$\boldsymbol{l}_2=\begin{pmatrix}0\\\hline\\\boldsymbol{l}(2)\\\end{pmatrix},\quad \boldsymbol{u}_2^T=\left(\begin{array}{c|c}0&\boldsymbol{u}(2)^T\end{array}\right)$$

$$\left(\begin{array}{c|ccc}0&0&&\cdots&&0\\\hline 0\\\vdots&&&A(2)\\0\\\end{array}\right)
-\boldsymbol{l}_2\boldsymbol{u}_2^T=
\left(\begin{array}{cc|ccc}0&0&0&\cdots&0\\0&0&0&\cdots&0\\\hline 0&0\\\vdots&\vdots&&A(3)\\0&0\\\end{array}\right)$$

最终可以算得 $A=\boldsymbol{l}_1\boldsymbol{u}_1^T+\cdots+\boldsymbol{l}_s\boldsymbol{u}_s^T+O$ 的全部数字

在实际开发之中，一方面可以把 L 和 U 矩阵合并存放在一起（L的对角线部分不需要存储），一方面可以共用原矩阵 A 的空间，因为所需计算不会依赖于已经被覆盖的元素，如下图中▲代表处理中的原矩阵，□代表算出来的L，■代表算出来的U

\begin{pmatrix}■&■&■&■&■\\□&■&■&■&■\\□&□&▲&▲&▲\\□&□&▲&▲&▲\\□&□&▲&▲&▲\end{pmatrix}

## LU分解求行列式值
基于行列式形式，以及下三角和上三角矩阵行列式都是对角元素乘积的性质，可得：

$$\det A = \det(LU) = \det L \det U=\det U=U的对角元素乘积$$

## LU分解求线性方程组
将寻找满足 $A\boldsymbol{x}=\boldsymbol{y}$ 的向量 $\boldsymbol{x}$，转变为：

- 寻找满足 $L\boldsymbol{z}=\boldsymbol{y}$ 的 $\boldsymbol{z}$
- 寻找满足 $U\boldsymbol{x}=\boldsymbol{z}$ 的 $\boldsymbol{x}$

第一步，可以轻松通过依次带入，依次算出 $z_1,z_2,\cdots,z_s$：
$$\begin{pmatrix} 1\\钱&1\\孙&郑&1\\李&王&卫&1 \end{pmatrix}
\begin{pmatrix}z_1\\z_2\\z_3\\z_4\end{pmatrix}=
\begin{pmatrix}子\\丑\\寅\\卯\end{pmatrix}$$

第二步，通过同样操作，也可以依次算出 $x_s,x_{s-1},\cdots,x_1$：
$$\begin{pmatrix} 赵&钱&孙&李\\&吴&郑&王\\&&楚&魏\\&&&杨 \end{pmatrix}
\begin{pmatrix}x_1\\x_2\\x_3\\x_4\end{pmatrix}=
\begin{pmatrix}z_1\\z_2\\z_3\\z_4\end{pmatrix}$$

其实计算过程与消元法本质上是一致的，只不过消元法是通过初等变换直接解出 $L\boldsymbol{z}=\boldsymbol{y}$，并没有中途算出 $L$

## LU分解求逆矩阵
类似前面求逆矩阵方法，通过 $AX=I$ 分拆为多个线性方程组任务 $A(\boldsymbol{x}_1,\cdots,\boldsymbol{x}_n)=(\boldsymbol{e}_1,\cdots,\boldsymbol{e}_n)$，自然可以算得

一次LU分解，可以用于多次线性方程组计算，因此大大降低了运算量

## LU分解步骤2：意外情况
当第k步时遇到当前对角线上主元已经是0时，则遇到了意外，因为无法算倒数，即 $a_{11}(k)=0$，此时需要从其他行任意选择一个对应位置非0元素作为替换主元

$$A=\boldsymbol{l}_1\boldsymbol{u}_1^T+\left(\begin{array}{c|cc}
0&0&0&0\\\hline
0&\boxed{0}&周&冯\\
0&钱&吴&陈\\
0&孙&郑&褚\\
\end{array}\right)$$

$$A'=\boldsymbol{l}'_1\boldsymbol{u}_1^T+\left(\begin{array}{c|cc}
0&0&0&0\\\hline
0&\boxed{孙}&郑&褚\\
0&钱&吴&陈\\
0&\boxed{0}&周&冯\\
\end{array}\right)$$

安装初等变换记法，有 $A'=S_{2,4}A$，则 $A=S_{2,4}^{-1}LU=S_{2,4}LU$，由于可以多次变换，所以最终：
$$A=PLU\\P=S_{*,*}S_{*,*}\cdots S_{*,*}$$

（其中矩阵P，每一行中恰好有一个1，每一列中也恰好有一个1，其他元素为0，称之为**置换矩阵**）

对于计算行列式，则需要看 $\det P$，也就是其中S变换的个数为偶数时不变号，为奇数时变号

对于线性方程组，由于 $P^{-1}=P^T$，则计算 $LU\boldsymbol{x}=\boldsymbol{y}'\quad(\boldsymbol{y}'\equiv P^T \boldsymbol{y})$

更极端的情况下，其他行对应位置也全部为0，则需要允许列交换：
$$A=PLUP'\quad(P,P'均为置换矩阵)$$

如果其他行、其他列都为0，也就分解完毕了

但从实践来说，可逆矩阵一定可以分解成 $A=PLU$ 形式，所以通常遇到必须列交换或提前分解完毕时，已经可以确定矩阵不可逆，无需后续操作了


----
* {% post_link linear-algebra-note-1 %}
* {% post_link linear-algebra-note-2 %}
* {% post_link linear-algebra-note-3 %}
* {% post_link linear-algebra-note-4 %}
