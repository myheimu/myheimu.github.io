---
title: 《程序员的数学3：线性代数》笔记3
date: 2019-05-19
updated: 2019-05-19
categories:
- 数学
tags:
- 读书笔记
- 线性代数
permalink: linear-algebra-note-3
mathjax: true
---

* {% post_link linear-algebra-note-1 %}
* {% post_link linear-algebra-note-2 %}
* {% post_link linear-algebra-note-3 %}

----

# 第4章 特征值、对角化、Jordan标准型——判断失控风险
## 稳定性
可以构想不同输入 $u$ 下，一个“魔法箱”（**差分方程**）可以反馈 $\xi$，而该“魔法箱”包含了时间因素和先前 $u$ 的因素
$$u\Longrightarrow {\Large\boxed{魔法箱}} \Longrightarrow\xi$$

一种简单的“魔法盒”就是**自回归模型**：

- 离散时间例子：
$$\xi(t)=-0.5\xi(t-1)+0.34\xi(t-2)+0.08\xi(t-3)+2u(t)$$

- 连续时间例子：
$$\frac{\mathrm{d}^2}{\mathrm{d}t^2}\xi(t)=-3\frac{\mathrm{d}}{\mathrm{d}t}\xi(t)-2\xi(t)+2u(t)$$

随着时间推迟，$|\xi(t)|$是否会趋向于无限大（失控）？

严格定义，“不失控”是指对于任意初始值 $\boldsymbol{x}(0)$，总可以找到一个足够大的数 M，满足任意时刻 t，总有 $|x_i(t)|<M\ (i=1,...,n)$ 成立

“稳定”（李亚普诺夫稳定），表示保持在附近，即对于无论多么小的 $\epsilon>0$，总能找到足够小的 $\delta>0$，满足从与 $\boldsymbol{c}$ 点距离不超过 $\delta$ 的点 $\boldsymbol{x}(0)$ 出发，在任何时刻t，$\boldsymbol{c}$ 与  $\boldsymbol{x}(t)$ 之间距离都保持在 $\epsilon$ 以内

“不失控”是全局性概念，“稳定”则是局部性概念

差分方程有众多形式，以下只考虑无外部输入（例如$u(t)$）情况下的自回归模型

## 一维情况
一般而言，对于系统 $x(t)=ax(t-1)$，可以得到 $x(t)=a^tx(0)$，如果 $|a|>1$ 则失控，否则不失控

## 对角矩阵情况
设 $\boldsymbol{x}(t)=(x_1(t),\cdots,x_n(t))^T$，系数矩阵是对角矩阵 $A=\mathrm{diag}(a_1,\cdots,a_n)$，系统为 $\boldsymbol{x}(t)=A\boldsymbol{x}(t-1)$，则可得：

$$\boldsymbol{x}(t)=\mathrm{diag}(a_1^t,\cdots,a_n^t)\boldsymbol{x}(0)$$

只要 $|a_1|,\cdots,|a_n|$ 中任一大于1，则系统失控，反之系统不失控

## 可对角化情况
### 对角化
选择特定的矩阵 $C$，将 $\boldsymbol{x}(t)$ 变成另一组 $\boldsymbol{y}(t)=C\boldsymbol{x}(t)$

将关于 $\boldsymbol{x}(t)$ 的差分方程改写成关于 $\boldsymbol{y}(t)$ 的差分方程

期望新方程的系数矩阵是对角矩阵，从而求解 $\boldsymbol{y}(t)$，然后再反推回  $\boldsymbol{x}(t)$ 

由于矩阵 $C$ 必须可逆，为了方便，记 $P=C^{-1}$

$$\boldsymbol{x}(t)=P\boldsymbol{y}(t)$$

$$\boldsymbol{y}(t)=P^{-1}\boldsymbol{x}(t)=P^{-1}A\boldsymbol{x}(t-1)=(P^{-1}AP)\boldsymbol{y}(t-1)$$

可记为：
$$\boldsymbol{y}(t)=\Lambda\boldsymbol{y}(t-1)\\ \Lambda=P^{-1}AP$$

期望 $\Lambda$ 为对角矩阵，则可以求得：
$$\boldsymbol{y}(t)=\Lambda^t\boldsymbol{y}(0)$$
$$\boldsymbol{x}(t)=P\boldsymbol{y}(t)=P\Lambda^t\boldsymbol{y}(0)=P\Lambda^tP^{-1}\boldsymbol{x}(0)$$

最核心问题变成：找到合适的可逆矩阵 $P$，使得 $P^{-1}AP$ 是对角矩阵，也就是**对角化**

PS：对于方阵A和某个可逆矩阵P，$P^{-1}AP$ 称之为**相似变换**
### 对角化算法
$$P^{-1}AP\equiv \Lambda=\mathrm{diag}(\lambda_1,\cdots,\lambda_n)$$

将矩阵 $P$ 分解为列向量 $(\boldsymbol{p}_1,\cdots,\boldsymbol{p}_n)$，上式两边左乘 P，可变换为：
$$A(\boldsymbol{p}_1,\cdots,\boldsymbol{p}_n)=(\boldsymbol{p}_1,\cdots,\boldsymbol{p}_n)\mathrm{diag}(\lambda_1,\cdots,\lambda_n)$$

分拆为：
$$A\boldsymbol{p}_1=\lambda_1\boldsymbol{p}_1\\\vdots\\A\boldsymbol{p}_n=\lambda_n\boldsymbol{p}_n$$

即寻找
$$A\boldsymbol{p}=\lambda\boldsymbol{p}\quad(\boldsymbol{p}\ne \boldsymbol{o})$$

其中数 $\lambda$ 即**特征值**，向量 $\boldsymbol{p}$ 即**特征向量**

最后问题变为，这些特征值 $|\lambda_1|,\cdots,|\lambda_n|$ 中任一大于1，则失控，反之，则不失控

### 坐标变换角度理解
将n维向量考虑为n维空间内的坐标，将矩阵A考虑为映射 $\mathcal{A}(\vec{v})$，则上述系统可以表示为：
$$\vec{x}(t)=\mathcal{A}(\vec{x}(t-1))\quad 其中\vec{x}(t)=x_1(t)\vec{e}_1+\cdots+x_n(t)\vec{e}_n$$

设 A 的特征值 $\lambda_1,\cdots,\lambda_n$，而用 $\vec{p}_1,\cdots,\vec{p}_n$ 表示对应的特征向量，使用这些向量作为基底，则可以表示为：
$$\vec{x}(t)=y_1(t)\vec{p}_1+\cdots+y_n(t)\vec{p}_n$$

则有：
$$\mathcal{A}(\vec{x}(t-1))=\lambda_1 y_1(t)\vec{p}_1+\cdots+\lambda_n y_n(t)\vec{p}_n$$

相当于在原基底下，映射 $\mathcal{A}$ 比较别扭，而更换基底之后，映射 $\mathcal{A}$ 变成了简单的不同方向上的伸缩

### 乘方角度理解
$$\boldsymbol{x}(t)=A^t\boldsymbol{x}(0)$$

那么其实要求的就是 $A^t$，如果 $A$ 是对角矩阵，当然很好求，当它不是对角矩阵时，可以选择合适的可逆矩阵 $P$，使得 $P^{-1}AP$ 变成对角矩阵 $\Lambda$

$$(P^{-1}AP)^t=(P^{-1}AP)(P^{-1}AP)\cdots(P^{-1}AP)=P^{-1}A^tP$$

因此：
$$A^t=P(P^{-1}AP)^tP^{-1}=P\Lambda^tP^{-1}$$

## 特征值、特征向量
### 几何学意义
特征向量乘上矩阵 $A$ 之后，除了长度会随着对应特征值发生伸缩变化，方向不发生变化

即便是实矩阵，其特征值和特征向量也可能出现复数，即便出现复数，也不影响前面对失控的判断

### 特征值、特征向量的性质
* “A有0特征值”等价于“A是奇异矩阵”
* 上三角方阵或者下三角方阵，特征值就等于对角元素（特征向量却并不简单）
* 行列式就是特征值的积，即 $\det A=\det(P^{-1}AP)=\det\Lambda=\lambda_1\cdots\lambda_n$
    *  几何角度理解，选择特征向量作为基底，映射A就单纯变成了坐标轴方向的伸缩变换，那么其体积变换就可以用特征值的积来表示
* 不相等的一批特征值所对应的的特征向量，两两线性无关
* 如果n阶方阵 $A$ 有n个互不相同的特征值，则由其特征向量组成的矩阵可逆，并且可以用其进行对角化（逆命题不成立，有重复特征值情况下也可能可以对角化）

### 特征值的计算：特征方程
所谓向量 $\boldsymbol{p}$ 是n阶方阵 $A$ 的特征向量（特征值$\lambda$）

$$A\boldsymbol{p}=\lambda\boldsymbol{p}\quad \Longrightarrow\quad (\lambda I-A)\boldsymbol{p}=\boldsymbol{o} $$

在非零向量 $\boldsymbol{p}$ 上左乘 $(\lambda I-A)$ 得到了零向量，说明该矩阵进行了“压缩扁平化”

定义**特征多项式**（特征多项式等于0，等价于 λ 是 A 的特征值）
$$\phi_A(\lambda)\equiv \det(\lambda I-A)$$

**特征方程**： $\phi_A(\lambda)=0$

行列式计算方法确保了特征多项式是变量 λ 的 n 次多项式，那么在包括重根和复根的情况下，特征值也刚好是 n 个，其中互不相同的特征值个数不超过 n 个

将特征方程展开为 $\phi_A(\lambda)=\lambda^n-a_{n-1}\lambda^{n-1}+a_{n-2}\lambda^{n-2}-\cdots+(-1)^{n-1}a_1\lambda+(-1)^na_0$，这些系数 $a_i$ 都是相似变换下的不变量

对于任何可逆矩阵P，可得 $\phi_{P^{-1}AP}(\lambda)=\phi_A(\lambda)$，即系数 $a_i$ 不变

其中 $a_0=\det A$，而 $a_{n-1}$ 称为**迹**（trace），记为 $\mathrm{Tr}\ A$，等于 A 中对角线元素的和

### 附带：凯莱-哈密顿（Cayley-Hamilton）定理
凯莱-哈密顿定理即 $\phi_A(A)=O$，务必注意并非 $\det(AI-A)=0$ 的意思，而是向多项式 $\phi_A(\lambda)$ 中带入矩阵运算

例如 $A=\begin{pmatrix}2&-1\\4&3\end{pmatrix}$ 情况下：
$$\phi_A(\lambda)=\lambda^2-5\lambda+10$$

则可以通过该定理得到：
$$\phi_A(A)=A^2-5A+10=O$$

可以用于矩阵乘方的简化计算，或者用于判断线性系统的可控性（略）

### 特征向量的计算
先通过特征方程，算出根，即特征值之后，用特征值带入 $A\boldsymbol{p}=\lambda\boldsymbol{p}$ 形成线性方程组

无重复特征值情况下通常可以获得类似这样的特征向量：
$$\boldsymbol{p}=\alpha\begin{pmatrix}*\\\vdots\\*\end{pmatrix}，其中\alpha 为0以外任意数$$

有重复特征值情况下，k重的重复特征值可能解出包含k个特征向量的解，将其分解成线性无关的k个部分即可，例如：
$$\boldsymbol{q}=\beta\begin{pmatrix}*\\\vdots\\*\end{pmatrix}+\gamma\begin{pmatrix}*\\\vdots\\*\end{pmatrix}，其中\beta和\gamma 为0以外任意数$$

有重复特征值情况下，k重的重复特征根也可能无法取出足够个数的特征向量，后续处理

## 连续时间系统
### 微分方程
高阶微分可以考虑变成针对矩阵的一阶微分方程，例如设 $\boldsymbol{x}(t)=(\frac{\mathrm{d}}{\mathrm{d}t}q(t),q(t))^T$，则可以转换：
$$\frac{\mathrm{d}^2}{\mathrm{d}t^2}q(t)=-\frac{R}{L}\frac{\mathrm{d}}{\mathrm{d}t}q(t)-\frac{1}{LC}q(t)\\\Downarrow\\
\frac{\mathrm{d}}{\mathrm{d}t}\boldsymbol{x}(t)=\begin{pmatrix}-R/L&-1/(LC)\\1&0\end{pmatrix}\boldsymbol{x}(t)$$

以下研究判断 $\frac{\mathrm{d}}{\mathrm{d}t}\boldsymbol{x}(t)=A\boldsymbol{x}(t)$ 的微分方程，对应的系统是否有失控的危险

### 一阶情况
一般而言，对于方程
$$\frac{\mathrm{d}}{\mathrm{d}t}x(t)=ax(t)$$

解为 $x(t)=\mathrm{e}^{at}x(0)$，如果 $a>0$ 则会失控，否则不会失控

### 对角矩阵情况
$$\frac{\mathrm{d}}{\mathrm{d}t}\boldsymbol{x}(t)=A\boldsymbol{x}(t)\\
A=\mathrm{diag}(a_1,\cdots,a_n)\\
\boldsymbol{x}(t)=(x_1(t),\cdots,x_n(t))^T$$

则解为：
$$x_1(t)=\mathrm{e}^{a_1t}x_1(0)\\\vdots\\x_n(t)=\mathrm{e}^{a_nt}x_n(0)$$

### 可对角化情况
取可逆的矩阵 $P$，得到新函数 $\boldsymbol{y}(t)$，满足 $\boldsymbol{x}(t)=P\boldsymbol{y}(t)$

微分方程变成：
$$\frac{\mathrm{d}}{\mathrm{d}t}\boldsymbol{y}(t)=(P^{-1}AP)\boldsymbol{y}(t)$$

需要使得 $P^{-1}AP=\Lambda$ 成为对角矩阵

### 失控判断
在 A 可对角化的情况下：

* 实数特征值情况下，在所有 $a_i$ 中，任一为正数，则会失控，反之则不会失控
* 复数特征值情况下，$\mathrm{Re}\ a_i$ 任一为正数则失控，反之则不会失控

但是在不可对角化的情况下，则可能出现 $\mathrm{Re}\ \lambda_i=0$ 情况，这种情况下判断是否失控则很复杂（见后文）

## 不可对角化情况
离散时间系统 $\boldsymbol{x}(t)=A\boldsymbol{x}(t-1)$

* 在 A 的特征值中，只要有一个 $\lambda$ 满足 $|\lambda|>1$，则会失控
* 若所有特征值都满足 $|\lambda|<1$，则不会失控
* 若所有特征值都满足 $|\lambda|\le 1$，但存在 $|\lambda|=1$ 情况，则仅凭特征值无法判断

连续时间系统 $\frac{\mathrm{d}}{\mathrm{d}t}\boldsymbol{x}(t)=A\boldsymbol{x}(t)$

* 在 A 的特征值中，只要有一个 $\lambda$ 满足 $\mathrm{Re}\ \lambda>0$，则会失控
* 若所有特征值都满足 $\mathrm{Re}\ \lambda<0$，则不会失控
* 若所有特征值都满足 $\mathrm{Re}\ \lambda\le 0$，但存在 $\mathrm{Re}\ \lambda=0$ 情况，则仅凭特征值无法判断

### Jordan标准型
$$J=\left(\begin{array}{ccc|cc|cc|c}
3&1\\&3&1\\&&3\\\hline
&&&3&1\\&&&&3\\\hline
&&&&&4&1\\&&&&&&4\\\hline
&&&&&&&5\\
\end{array}\right)\quad （其他元素都为0）$$

Jordan标准型矩阵满足条件：

* 分块对角矩阵（分块的矩阵中，除了对角区块外，均为0）
* 对角区块位于对角线上的元素相同，并且右上方斜线上的元素全为1 （该块称之为Jordan块）

在不考虑区块顺序的情况下，Jordan标准型是唯一的

### Jordan标准型性质
#### 特征值
* 对角元素就是特征值
* 对角线上有几个相同的特征值λ，对应的特征值λ就是几重根（代数重数）
* 对角元素是λ的Jordan块有几个，对应的线性无关的特征向量就有几个（几何重数）

例如上面 $J$ 中：

* 特征值为3（3+2=5重根）、4（2重根）、5
* 特征值3对应的特征向量为$(\alpha,0,0,\beta,0,0,0,0)^T$（2个线性无关特征向量）（α、β不能同时为0），
* 特征值4对应的特征向量为$(0,0,0,0,0,\gamma,0,0)^T$（γ不为0）
* 特征值5对应的特征向量为$(0,0,0,0,0,0,0,\delta)^T$（δ不为0）

如果不存在重根，则Jordan标准型一定是对角矩阵形式，即可对角化

#### 乘方
分解Jordan块：$B=\begin{pmatrix}7&1&0&0\\0&7&1&0\\0&0&7&1\\0&0&0&7\end{pmatrix}$
$$B=7I+Z, Z=\begin{pmatrix}0&1&0&0\\0&0&1&0\\0&0&0&1\\0&0&0&0\end{pmatrix}$$

其中 $Z$ 起到了“对于给定矩阵，左乘则上移一行，右乘则右移一行”作用，则有：
$$Z^2=\begin{pmatrix}0&0&1&0\\0&0&0&1\\0&0&0&0\\0&0&0&0\end{pmatrix},Z^3=\begin{pmatrix}0&0&0&1\\0&0&0&0\\0&0&0&0\\0&0&0&0\end{pmatrix}, Z^4=Z^5=\cdots=O$$

一般而言，可以计算：
$$B^t=\begin{pmatrix}7^t&t\cdot 7^{t-1}&C^2_n\cdot 7^{t-2}&C^3_n\cdot 7^{t-3}\\0&7^t&t\cdot 7^{t-1}&C^2_n\cdot 7^{t-2}\\0&0&7^t&t\cdot 7^{t-1}\\0&0&0&7^t\end{pmatrix}$$

也可以记为另外一种方式，设 $f(\lambda)=\lambda^t$，$f^{(s)}(\lambda)=\frac{\mathrm{d}^s}{\mathrm{d}\lambda^s}f(\lambda)$

$$B^t=\begin{pmatrix}f(7)&f^{(1)}(7)&\frac{1}{2!}f^{(2)}(7)&\frac{1}{3!}f^{(3)}(7)\\0&f(7)&f^{(1)}(7)&\frac{1}{2!}f^{(2)}(7)\\0&0&f(7)&f^{(1)}(7)\\0&0&0&f(7)\end{pmatrix}$$

对于Jordan标准型求乘方，只需要将每个Jordan块分别求乘方即可，例如：
$$J^t=\begin{pmatrix}B_1^t&O&O&O\\O&B_2^t&O&O\\O&O&B_3^t&O\\O&O&O&B_4^t\end{pmatrix}$$

对于方阵A，能转化为Jordan标准型J，则有：
$$A^t=(PJP^{-1})^t=PJ^tP^{-1}$$

### Jordan标准型解决初始值问题（判别失控的最终结论）
根据Jordan块区分成子系统，任一子系统失控，则整体系统失控，反之则整体系统不失控

#### 离散时间系统
设Jordan块 B，大小 $m\times m$，对于离散时间系统 $\boldsymbol{y}(t)=B\boldsymbol{y}(t-1)$，可得：
$$\boldsymbol{y}(t)=B^t \boldsymbol{y}(t-1)$$

- 当 $|\lambda|>1$ 时，失控
- 当 $|\lambda|=1$ 时，根据B的大小不同而不同
    -  $m\ge 2$时，失控（从上面乘方公式，可以看到一些元素取向无穷大）
    -  $m=1$ 时，不失控
- 当 $|\lambda|<1$ 时，不失控

然后按规则扩展到整个Jordan标准型

#### 连续时间系统
设Jordan块 B，大小 $m\times m$，对于连续时间系统 $\frac{\mathrm{d}}{\mathrm{d}t}\boldsymbol{y}(t)=B\boldsymbol{y}(t)$，可以拆分为：
$$\frac{\mathrm{d}}{\mathrm{d}t}y_1(t)=\lambda y_1(t)+y_2(t)\\\vdots\\
\frac{\mathrm{d}}{\mathrm{d}t}y_{m-1}(t)=\lambda y_{m-1}(t)+y_m(t)\\
\frac{\mathrm{d}}{\mathrm{d}t}y_{m}(t)=\lambda y_{m}(t)$$

可以从后向前挨个带入计算，最终得到（以m=6为例）：
$$\begin{pmatrix}y_1(t)\\y_2(t)\\y_3(t)\\y_4(t)\\y_5(t)\\y_6(t)\end{pmatrix}=\mathrm{e}^{tB}
\begin{pmatrix}y_1(0)\\y_2(0)\\y_3(0)\\y_4(0)\\y_5(0)\\y_6(0)\end{pmatrix},\quad
\mathrm{e}^{tB}=\mathrm{e}^{\lambda t}
\begin{pmatrix}
1&t&\tfrac{1}{2!}t^2&\tfrac{1}{3!}t^3&\tfrac{1}{4!}t^4&\tfrac{1}{5!}t^5\\
&1&t&\tfrac{1}{2!}t^2&\tfrac{1}{3!}t^3&\tfrac{1}{4!}t^4\\
&&1&t&\tfrac{1}{2!}t^2&\tfrac{1}{3!}t^3\\
&&&1&t&\tfrac{1}{2!}t^2\\
&&&&1&t\\
&&&&&1\\
\end{pmatrix}$$

（上式中 $\mathrm{e}^{tB}$ 称为**矩阵的指数函数**，是对普通指数函数的一种扩展，基于 $\mathrm{e}^{tb}=1+tb+\frac{t^2b^2}{2!}+\frac{t^3b^3}{3!}+\frac{t^4b^4}{4!}+\cdots$，将其中数字b替换为矩阵B）

- 当 $\mathrm{Re}\ \lambda >0$，则失控
- 当 $\mathrm{Re}\ \lambda =0$，则与B大小有关
    - $m\ge 2$时，失控
    - $m=1$时，不失控
- 当 $\mathrm{Re}\ \lambda <0$，则不失控

然后按规则扩展到整个Jordan标准型

### 化Jordan标准型的方法
化Jordan标准型，也就是找到可逆矩阵 P，使得 $P^{-1}AP=J$，针对P的列向量 $\boldsymbol{p}_1,\cdots,\boldsymbol{p}_n$，可以推导出类似以下的关系：
$$\begin{cases}
\boldsymbol{o}\xleftarrow{3}\boldsymbol{p}_1\xleftarrow{3}\boldsymbol{p}_2\xleftarrow{3}\boldsymbol{p}_3\xleftarrow{3}\boldsymbol{p}_4\xleftarrow{3}\boldsymbol{p}_5\\
\boldsymbol{o}\xleftarrow{3}\boldsymbol{p}_6\xleftarrow{3}\boldsymbol{p}_7\\
\boldsymbol{o}\xleftarrow{4}\boldsymbol{p}_8\\
\boldsymbol{o}\xleftarrow{5}\boldsymbol{p}_9\xleftarrow{5}\boldsymbol{p}_{10}\xleftarrow{5}\boldsymbol{p}_{11}\\
\end{cases}$$

（其中 $\xleftarrow{\lambda}$ 表示左乘上 $(A-\lambda I)$ 矩阵操作）

根据定义，以上的 $\boldsymbol{p}_1,\boldsymbol{p}_6,\boldsymbol{p}_8,\boldsymbol{p}_9$ 为A的特征向量，而 $3,4,5$ 为特征值；而所有的 $\boldsymbol{p}_i$ 可以称为**广义特征向量**

#### 求解过程
根据特征方程 $\phi_A(\lambda)\equiv \det(\lambda I-A)=0$ 求解，例如 $\phi_A(\lambda)=(\lambda-3)^7(\lambda-4)(\lambda-5)^3$，则有特征值：

- $\lambda=3$（7重根），对应了7个广义特征向量（设为 $\boldsymbol{p}_1,\cdots,\boldsymbol{p}_7$）
- $\lambda=4$，对应了1个特征向量（设为 $\boldsymbol{p}_8$）
- $\lambda=5$（3重根），对应了3个广义特征向量（设为 $\boldsymbol{p}_9,\cdots,\boldsymbol{p}_{11}$）

**无重根情况**
对于无重根的特征值 4，只需要计算满足 $(A-4I)\boldsymbol{p}_8=\boldsymbol{o},\boldsymbol{p}_8\ne\boldsymbol{o}$ 的特征向量 $\boldsymbol{p}_8$ 即可

**有重根情况**
对于有k重根的特征值，首先看最多可以取多少个特征向量：

计算 $\mathrm{rank}(A-\lambda I)$，然后通过维数定理，得到 $\dim \mathrm{Ker}(A-\lambda I)=n-\mathrm{rank}(A-\lambda I)$，即为特征向量个数（也就是该特征值的几何重数）

**如果几何重数为1**，例如特征值5，则为一个3大小的Jordan块，可以递推出：
$$(A-5I)\boldsymbol{p}_9=\boldsymbol{o}\\
(A-5I)\boldsymbol{p}_{10}=\boldsymbol{p}_9\\
(A-5I)\boldsymbol{p}_{11}=\boldsymbol{p}_{10}$$

为了尽量不需要回溯查找，应当先从远处找起：（如果有多解，可以任选，但也有可能需要回溯）
$$(A-5I)^3\boldsymbol{p}_{11}=\boldsymbol{o}\\
\boldsymbol{p}_{10}=(A-5I)\boldsymbol{p}_{11}\\
\boldsymbol{p}_{9}=(A-5I)\boldsymbol{p}_{10}$$

**如果几何重数等于重根数**，则意味着是k个1大小的Jordan块，则直接求$(A-\lambda I)\boldsymbol{p}_i=\boldsymbol{o}$ 的k个非零特征向量即可

**如果几何重数大于1、小于重根数**，例如特征值3，假设算出来为7重根，且有2个几何重数

记 $K_i=\dim\mathrm{Ker}(A-3I)^i$，该值即表示有多少可以在i步以内左乘上 $A-3I$ 而变成零矩阵

此处有三种情况：

- 一个6大小和一个1大小的Jordan块，应当$K_1=2,K_2=3,K_3=4,K_4=5,K_5=6,K_6=7$
- 一个5大小和一个2大小的Jordan块，应当$K_1=2,K_2=4,K_3=5,K_4=6,K_5=7,K_6=7$
- 一个4大小和一个3大小的Jordan块，应当$K_1=2,K_2=4,K_3=6,K_4=7,K_5=7,K_6=7$

因此通过计算 $K_i$ 就可以算出属于如何分组，假设此处最终确定是一个5一个2

然后从最远处出发，先找 $(A-3I)^5\boldsymbol{p}_5=\boldsymbol{o}$，然后反推回 $\boldsymbol{p}_1$，过程中如有多解，可以任选，但如果遇到只有零解，则需要回溯

最后找 $(A-3I)^2\boldsymbol{p}_7=\boldsymbol{o}$，然后反推到 $\boldsymbol{p}_6$

过程中时刻注意不要出现零向量，或者重复向量，要保证全部广义特征向量线性不相关，否则拼凑起来的矩阵不可逆

### 任何方阵都可以化Jordan标准型的证明
对于任意 n 阶方阵 A，要证明存在 n 个线性无关的向量 $\boldsymbol{p}_1,\cdots,\boldsymbol{p}_n$，满足某种分组，可以推导出类似以下的关系：
$$\begin{cases}
\boldsymbol{o}\xleftarrow{3}\boldsymbol{p}_1\xleftarrow{3}\boldsymbol{p}_2\xleftarrow{3}\boldsymbol{p}_3\xleftarrow{3}\boldsymbol{p}_4\xleftarrow{3}\boldsymbol{p}_5\\
\boldsymbol{o}\xleftarrow{3}\boldsymbol{p}_6\xleftarrow{3}\boldsymbol{p}_7\\
\boldsymbol{o}\xleftarrow{4}\boldsymbol{p}_8\\
\boldsymbol{o}\xleftarrow{5}\boldsymbol{p}_9\xleftarrow{5}\boldsymbol{p}_{10}\xleftarrow{5}\boldsymbol{p}_{11}\\
\end{cases}$$

特征值 $\lambda$ 对应的“左乘 $(A-\lambda I)$ 若干次后变成 $\boldsymbol{o}$”的向量们构成的集合 $W(\lambda)$，称之为 $\lambda$ 对应的广义特征子空间；其中满足 $A\boldsymbol{p}=\lambda\boldsymbol{p}$ 的向量们称之为 $\lambda$ 的特征子空间（这里 $\boldsymbol{o}$虽然属于所有的广义特征子空间和特征子空间，但计数、统计之类均不计入）

**证明**：若 $\lambda$ 是特征方程 $\phi_A(\lambda)=0$ 的k重根，则 $W(\lambda)$ 中保证可以取到 k 个线性无关的向量（过程略，书上有详细过程，主要通过构造法）

**证明**：除了 $\boldsymbol{o}$ 以外，任何向量都不会出现在两个不同 $\lambda$ 对应的 $W(\lambda)$ 内（过程略，书上有详细过程，主要通过反证）

**证明**：不同的特征值对应的 $W(\lambda_i)$ 中分别任取一个非零向量，它们之间是线性无关的（过程略，书上有详细过程，主要通过反证）

**证明**：对于 n 阶方阵 A，特征值为 $\lambda_1,\cdots,\lambda_r$，分别是特征方程的 $k_i,\cdots,k_r$ 重根，通过巧妙选取一个可逆阵 Q，可以使得 $Q^{-1}AQ$ 变成一个特殊的分块对角矩阵：
$$Q^{-1}AQ=
\left(\begin{array}{c|c|c|c}D_1\\\hline\\&D_2\\\hline&&\ddots\\\hline\\&&&D_r\end{array}\right)
\equiv D\quad (空白处为O)\\
D_i: k_i\ 阶方阵\\
(D_i-\lambda_i I)^h\ 随\ h\ 增大会总会变成\ O$$

例如上面例子，可以从各 $W(\lambda_i)$ 中挑选出n个线性无关的向量，整体构成一组基底，并且每一部分也构成基底：

- $\boldsymbol{p}_1,\cdots,\boldsymbol{p}_7$ 构成 $W(3)$ 的基底
- $\boldsymbol{p}_8$ 构成 $W(4)$ 的基底
- $\boldsymbol{p}_9,\cdots,\boldsymbol{p}_{11}$ 构成 $W(5)$ 的基底

将这些向量组合起来，即可构成需要的矩阵 Q:
$$Q\equiv \left(\begin{array}{ccc|c|ccc}\vphantom{\begin{matrix}a\\\\\\\\\\\\b\end{matrix}}\boldsymbol{p}_1&\cdots&\boldsymbol{p}_7&\boldsymbol{p}_8&\boldsymbol{p}_9&\boldsymbol{p}_{10}&\boldsymbol{p}_{11}\end{array}\right)$$

可得 $AQ=QD$ 的 $D$ 满足上述要求（完整证明略）

**证明**：对于指定区块 $D_i$，可以找到合适的可逆矩阵 $R_i$，使得 $R_i^{-1}D_iR_i\equiv J_i$ ，最终可以汇总起来变成Jordan标准型（每一个 $J_i$ 中可能有多个Jordan块）：
$$R^{-1}DR=
\left(\begin{array}{c|c|c}R_1^{-1}\\\hline &\ddots\\\hline && R_r^{-1}\end{array}\right)
\left(\begin{array}{c|c|c}D_1\\\hline &\ddots\\\hline && D_r\end{array}\right)
\left(\begin{array}{c|c|c}R_1\\\hline &\ddots\\\hline && R_r\end{array}\right)\\=
\left(\begin{array}{c|c|c}J_1\\\hline &\ddots\\\hline && J_r\end{array}\right)\equiv J$$

满足“若干次方后等于O”的矩阵，称之为**幂零矩阵**；可以通过类似于推算广义特征向量的思路，严格证明幂零矩阵 $Z$ 可以找到合适的可逆矩阵 $P$，从而满足（证明略）：
$$P^{-1}ZP\equiv F$$

其中 $F$ 是“特征值为0的Jordan标准型”

由于 $D_i-\lambda_i I$ 为幂零矩阵，从而可得 $R_i^{-1}D_iR_i=F_i+\lambda_i I$，为Jordan标准型

最终完整证明全套（详细证明略）

# 第5章 计算机上的计算（2）——特征值算法
高次代数方程在计算机中求解，受到精度影响误差可能很大

那么可以绕开解特征方程方法，通过寻找可逆矩阵 $P$，使得 $P^{-1}AP=(对角矩阵或上三角矩阵)$ （即对角化或上三角化），从而使得对角元素就是要求的特征值

### 伽罗华（Galois）理论
**n次代数方程**，例如1到4次的代数方程：
$$\begin{aligned}
ax+b&=0\\
ax^2+bx+c&=0\\
ax^3+bx^2+cx+d&=0\\
ax^4+bx^3+cx^2+dx+e&=0\\
\end{aligned}$$

1次方程解为 $x=-\frac{b}{a}$，2次方程解为 $x=\frac{-b\pm\sqrt{b^2-4ac}}{2a}$，3次方程使用Cardano公式（Tartaglia公式），4次方程使用Ferrari公式

**“5次及以上代数方程没有求解公式”** （求解公式限于对系数进行加减乘除、方根等基础运算）

对于任意方阵A'，可以进行相似变换到 A：
$$A=\begin{pmatrix}
0&0&\cdots&0&-a_0\\
1&0&\cdots&0&-a_1\\
0&1&\ddots&\vdots&\vdots\\
\vdots&\ddots&\ddots&0&-a_{n-2}\\
0&\cdots&0&1&-a_{n-1}\\
\end{pmatrix}$$

则特征方程可以通过计算 $\det(\lambda I-A)$ 得到，即：
$$\lambda^n+a_{n-1}\lambda^{n-1}+a_{n-2}\lambda^{n-2}+\cdots+a_1\lambda+a_0=0$$

称矩阵 A 为此代数方程的**友矩阵**

由于伽罗华理论，所以也可以推断出**“5次以上矩阵的特征值一定不存在通用的求解方法/求解步骤”**

只有一些通过不断逼近，求近似值的方法，比如 Jacobi 方法和 QR 方法

## Jacobi方法
Jacobi 方法是 Carl Gustav Jacob Jacobi 于1846年发表的算法，即使放在现在而言，对于10×10以内矩阵，它也是很有效的算法，即便对于更大的矩阵，虽然速度比QR等算法慢一些，但精度上更佳

另外 Jacobi 方法也可以用于（近似）对角化

### 平面旋转
定义 $n\times n$ 矩阵：
$$R(\theta,p,q)=\begin{pmatrix}
1\\
&\ddots\\
&&1\\
&&&\cos\theta&&&&-\sin\theta\\
&&&&1\\
&&&&&\ddots\\
&&&&&&1\\
&&&\sin\theta&&&&\cos\theta\\
&&&&&&&&1\\
&&&&&&&&&\ddots\\
&&&&&&&&&&1\\
\end{pmatrix}\quad(空白元素都是0)\\
\cos\theta位于(p,p)和(q,q)位置\\
\sin\theta位于(q,p)位置，-\sin\theta位于(p,q)位置$$

也就是说 $R(\theta,p,q)$ 几乎就是一个n阶单位矩阵，只是其中四个位置被替换成了2*2旋转矩阵中的四个元素：
$$R(\theta)=\begin{pmatrix}\cos\theta&-\sin\theta\\\sin\theta&\cos\theta\end{pmatrix}$$

考虑 $R(\theta,1,2)$，其几何含义就是将三维空间内的点，保持 z 轴不变，在 x-y 平行平面上旋转 $\theta$ 角度；考虑 $R(\theta,2,3)$，其几何含义就是保持 x 轴不变，在 y-z 平行平面上旋转；考虑 $R(\theta,1,3)$，即保持 y 轴不变，在 x-z 平行平面上旋转

一般而言：
$$R(\theta,p,q)\begin{pmatrix}x_1\\\vdots\\x_p\\\vdots\\x_q\\\vdots\\x_n\end{pmatrix}=
\begin{pmatrix}x_1\\\vdots\\x_p\cos\theta-x_q\sin\theta\\\vdots\\x_p\sin\theta+x_q\cos\theta\\\vdots\\x_n\end{pmatrix}$$

几何含义为，除了 $x_p$ 和 $x_q$ 以外，其他轴位置不变，而在第 p 和第 q 轴构成平面上，受到旋转矩阵 $R(\theta)$ 的影响

旋转矩阵 $R(\theta)$ 满足 $R(\theta)R(\theta)^T=I$，即为正交矩阵，有转置矩阵等于逆矩阵

同样也可推导出 $R(\theta,p,q)$ 是正交矩阵，有转置矩阵等于逆矩阵

### 通过平面旋转进行相似变换
Jacobi 方法就是：对于给定矩阵 A，选择不同的 $p,q,\theta$，通过平面旋转反复进行如下相似变换，直到矩阵接近对角化形式为止：
$$A'=R(\theta,p,q)^TAR(\theta,p,q)$$

可以推导如下：（详细推导略）
$$\begin{pmatrix}
&&a'_{1p}&&a'_{1q}\\
&&\vdots&&\vdots\\
a'_{p1}&\cdots&a'_{pp}&\cdots&a'_{pq}&\cdots&a'_{pn}\\
&&\vdots&&\vdots\\
a'_{q1}&\cdots&a'_{qp}&\cdots&a'_{qq}&\cdots&a'_{qn}\\
&&\vdots&&\vdots\\
&&a'_{np}&&a'_{nq}\\
\end{pmatrix}\\
=R(\theta,p,q)^T
\begin{pmatrix}
&&a_{1p}&&a_{1q}\\
&&\vdots&&\vdots\\
a_{p1}&\cdots&a_{pp}&\cdots&a_{pq}&\cdots&a_{pn}\\
&&\vdots&&\vdots\\
a_{q1}&\cdots&a_{qp}&\cdots&a_{qq}&\cdots&a_{qn}\\
&&\vdots&&\vdots\\
&&a_{np}&&a_{nq}\\
\end{pmatrix}
R(\theta,p,q)\\（空白位置的元素数值不变）$$

由于 Jacobi 处理的矩阵 A是对称矩阵，所以变化的数值公式为：
$$a'_{pj}=\phantom{-}a_{pj}\cos\theta+a_{qj}\sin\theta\quad (j\ne p,q)\\
a'_{qj}=-a_{pj}\sin\theta+a_{qj}\cos\theta\quad (j\ne p,q)\\
a'_{ip}=\phantom{-}a_{ip}\cos\theta+a_{iq}\sin\theta\quad (i\ne p,q)\\
a'_{iq}=-a_{ip}\sin\theta+a_{iq}\cos\theta\quad (i\ne p,q)\\
a'_{pp}=a_{pp}\cos^2\theta+a_{qq}\sin^2\theta+2a_{pq}\sin\theta\cos\theta\\
a'_{qq}=a_{pp}\sin^2\theta+a_{qq}\cos^2\theta-2a_{pq}\sin\theta\cos\theta\\
a'_{pq}=a_{pq}(\cos^2\theta-\sin^2\theta)+(a_{qq}-a_{pp})\sin\theta\cos\theta$$

为了尽量对角化，则期望相似变换后使得 $a'_{pq}=0$，可以推导出：
$$\frac12\tan(2\theta)=\frac{a_{pq}}{a_{pp}-a_{qq}}\\
\theta=\frac12\tan^{-1}\frac{2a_{pq}}{a_{pp}-a_{qq}}$$

另外为了观察矩阵是否朝着对角化方向靠近，定义函数：
$$f(A)=\sum_{i\ne j}a_{ij}^2,\quad g(A)=\sum_i a_{ii}^2$$

期待非对角元素平方和 $f(A)$ 能够越来越小，然而可以计算得到 $a_{pj},a_{qj}$ 变化之后，$f(A)$ 并没有变化，因此只有 $a_{pq},a_{qp}$ 的变化才会影响 $f(A)$：
$$f(A')=f(A)-2a_{pq}^2$$

因此整体逻辑就是寻找使 $a_{pq}$ 最大的 $p,q\ (p\ne q)$，并反复进行使得 $a'_{pq}=0$ 的旋转，使得 $f(A)$ 趋向于0

### 计算过程优化
并不需要真的计算出 $\theta$，前面已经得知 $\tan(2\theta)$ 的值，则：
$$\cos\theta=\sqrt{\frac12(1+\frac{1}{\sqrt{1+\tan^2 2\theta}})}\\
\sin\theta=\sqrt{1-\cos^2\theta}$$

## 幂法原理
幂法可以用于求绝对值最大、最小的特征值，乃至所有特征值，但主要为后面QR方法和反幂法做铺垫

### 求绝对值最大的特征值
在矩阵 $A(\ne O)$ 可对角化情况下，按特征值绝对值大小排序：
$$\begin{cases}
A\boldsymbol{x}_1=\lambda_1\boldsymbol{x}_1\\
A\boldsymbol{x}_2=\lambda_2\boldsymbol{x}_2\\\vdots\\
A\boldsymbol{x}_n=\lambda_n\boldsymbol{x}_n\\
\end{cases}\qquad
|\lambda_1|\ge|\lambda_2|\ge\cdots\ge|\lambda_n|
$$

适当选择初始向量 $\boldsymbol{v}$，反复左乘矩阵 $A$，则会渐渐靠近 $A$ 的绝对值最大的特征值对应的特征向量方向：
$$\boldsymbol{v},A\boldsymbol{v},A^2\boldsymbol{v},A^3\boldsymbol{v},\cdots\rightarrow(\boldsymbol{x}_1的方向)$$

对于适当选择的初始向量：
$$\boldsymbol{v}=v_1\boldsymbol{x}_1+v_2\boldsymbol{x}_2+\cdots+v_n\boldsymbol{x}_n$$

反复左乘 A，共 k 次，趋向无穷后，则有向量方向平行关系：
$$A^k\boldsymbol{v} \mathbin{\!/\mkern-5mu/\!} v_1\boldsymbol{x}_1+v_2(\frac{\lambda_2}{\lambda_1})^k\boldsymbol{x}_2+\cdots+v_n(\frac{\lambda_n}{\lambda_1})^k\boldsymbol{x}_n$$

只需要采用较大的 k，然后反推在该方向上伸缩了多少倍，除以 k，即得到绝对值最大的特征值 $\lambda_1$

在实际计算中为了避免数值过大过小导致精度问题，每一步需要进行归一化调整幅度

### 求绝对值最小的特征值
适当选择初始向量 $\boldsymbol{v}$，反复左乘逆矩阵 $A^{-1}$，则会渐渐靠近 $A$ 的绝对值最小的特征值对应的特征向量方向：
$$\boldsymbol{v},A^{-1}\boldsymbol{v},(A^{-1})^2\boldsymbol{v},(A^{-1})^3\boldsymbol{v},\cdots\rightarrow(\boldsymbol{x}_n的方向)$$

由于计算逆矩阵计算量较大，可以进行LU分解，然后将左乘 $A^{-1}$改变为计算线性方程组 $L\boldsymbol{z}=\boldsymbol{y}$ 和 $U\boldsymbol{x}=\boldsymbol{z}$

### QR分解
分解 $A=QR$，就是“Q是A的列向量的 **Gram-Schemidt 标准正交化**，R是在A的列向量的标准正交基下的坐标表示”

把矩阵 $A$ 分区为n个线性无关的n维列向量 $\boldsymbol{a}_1,\boldsymbol{a}_2,\cdots,\boldsymbol{a}_n$ 通过 Gram-Schemidt 方法进行正交化，得到正交基 $\boldsymbol{q}_1,\boldsymbol{q}_2,\cdots,\boldsymbol{q}_n$：
$$\begin{aligned}
\boldsymbol{q}_1=\boldsymbol{p}_1/\|\boldsymbol{p}_1\|, \quad& \boldsymbol{p}_1=\boldsymbol{a}_1\\
\boldsymbol{q}_2=\boldsymbol{p}_2/\|\boldsymbol{p}_2\|, \quad& \boldsymbol{p}_2=\boldsymbol{a}_2-(\boldsymbol{a}_2\cdot\boldsymbol{q}_1)\boldsymbol{q}_1\\
\boldsymbol{q}_3=\boldsymbol{p}_3/\|\boldsymbol{p}_3\|, \quad&\boldsymbol{p}_3=\boldsymbol{a}_3-(\boldsymbol{a}_3\cdot\boldsymbol{q}_1)\boldsymbol{q}_1-(\boldsymbol{a}_3\cdot\boldsymbol{q}_2)\boldsymbol{q}_2\\
\vdots\\
\boldsymbol{q}_n=\boldsymbol{p}_n/\|\boldsymbol{p}_n\|, \quad&
\boldsymbol{p}_n=\boldsymbol{a}_n-(\boldsymbol{a}_n\cdot\boldsymbol{q}_1)\boldsymbol{q}_1-\cdots-(\boldsymbol{a}_{n}\cdot\boldsymbol{q}_{n-1})\boldsymbol{q}_{n-1}\\
\end{aligned}$$

采用以上列向量 $\boldsymbol{q}_i$ 同样方式构成矩阵 $Q$

定义：
$$r_{ii}=\|\boldsymbol{p}_i\| \quad (1\le i \le n)\\
r_{ij}=\boldsymbol{a}_j\cdot\boldsymbol{q}_i\quad (1\le i < j \le n)$$

则可以将 Gram-Schemidt 标准正交化公式，改写为：
$$\begin{pmatrix}
a_{11}&a_{12}&\cdots&a_{1n}\\
a_{21}&a_{22}&\cdots&a_{2n}\\
\vdots&\vdots&\ddots&\vdots\\
a_{n1}&a_{n2}&\cdots&a_{nn}\\
\end{pmatrix}=
\begin{pmatrix}
q_{11}&q_{12}&\cdots&q_{1n}\\
q_{21}&q_{22}&\cdots&q_{2n}\\
\vdots&\vdots&\ddots&\vdots\\
q_{n1}&q_{n2}&\cdots&q_{nn}\\
\end{pmatrix}
\begin{pmatrix}
r_{11}&r_{12}&\cdots&r_{1n}\\
0&r_{22}&\cdots&r_{2n}\\
\vdots&\ddots&\ddots&\vdots\\
0&\cdots&0&r_{nn}\\
\end{pmatrix}$$

这就是矩阵 A 的 QR分解，把最右边矩阵记作 $R$，则为：
$$A=QR$$

因为矩阵 Q 各列都经过标准正交化，所以 $Q^TQ=I$，Q为正交矩阵，因此任意一个列向量线性无关的矩阵 A，都可以分解为正交矩阵 Q 和上三角矩阵 R 的乘积形式

实际之中并不会采用 Gram-Schemidt 标准正交化方法，因为会累计误差，而是多采用基于平面旋转变换和镜像变换算法

#### 正交矩阵集合构成李群
对于“n×n矩阵的全体”所构成集合中某个子集满足以下几点，则构成“群”：

- 该子集中含有单位矩阵
- 该子集中的矩阵的逆矩阵也在该子集内
- 该子集中的任意两个矩阵的乘积也在该子集内

可以得知“n×n正交矩阵的全体”所构成集合，“可逆的n×n上三角矩阵的全体”所构成的集合都符合上述“群”定义，并且他们是“连续的”矩阵群，也就是所谓“李群”的一种

### 求所有特征值
选择 n 个适当的线性无关的初始向量 $\boldsymbol{v}_1,\boldsymbol{v}_2,\cdots,\boldsymbol{v}_n$，对其反复左乘 A，然后把所有结果进行 Gram-Schemidt 标准正交化，那么最终结果就会接近 A 的特征向量所张成的子空间的标准正交基

对于按绝对值大小排列、且不存在绝对值相等的特征值 $\lambda_1,\lambda_2,\cdots,\lambda_n$，对应的特征向量 $\boldsymbol{x}_1,\boldsymbol{x}_2,\cdots,\boldsymbol{x}_n$

设 $A^k\boldsymbol{v}_1,A^k\boldsymbol{v}_2,\cdots,A^k\boldsymbol{v}_n$ 标准正交化之后得到 $\boldsymbol{q}_1(k),\boldsymbol{q}_2(k),\cdots,\boldsymbol{q}_n(k)$

随着 k 增大后，会有：（证明略，主要思想就是 r 个向量$\boldsymbol{v}_i$进行反复左乘 A，张成的 r 维空间，会突出前 r 个绝对值最大的特征值的方向）
$$\begin{aligned}
&\mathrm{span}\{\boldsymbol{q}_1(k)\}\rightarrow \mathrm{span}\{\boldsymbol{x}_1\}\\
&\mathrm{span}\{\boldsymbol{q}_1(k),\boldsymbol{q}_2(k)\}\rightarrow \mathrm{span}\{\boldsymbol{x}_1,\boldsymbol{x}_2\}\\
&\quad\vdots\\
&\mathrm{span}\{\boldsymbol{q}_1(k),\boldsymbol{q}_2(k),\cdots,\boldsymbol{q}_n(k)\}\rightarrow \mathrm{span}\{\boldsymbol{x}_1,\boldsymbol{x}_2,\cdots,\boldsymbol{x}_n\}\\
\end{aligned}$$

以上 $\boldsymbol{q}_i$ 作为列向量拼成的矩阵 $Q(k)$，即为 QR 分解结果：
$$A^kV=Q(k)R(k)$$

（证明略）可以推导 $Q(k)^TAQ(k)$ 会趋近于上三角矩阵，则计算该上三角矩阵，其对角元素就是特征值

## QR方法
QR 方法是 Francis 于1961年发表的算法，对于对称矩阵和非对称矩阵均使用

### QR方法原理
#### QR 迭代基本流程

- 对需要求解特征值的矩阵进行 QR 分解：$A_{k-1}=Q_{k-1}R_{k-1}$
- 对分解出来的结果进行逆向相乘：$A_k=R_{k-1}Q_{k-1}$

反复执行以上流程，最终将趋近一个上三角矩阵，其对角元素就是原矩阵的特征值

对于存在绝对值相等的特征值，幂法不能使用，所以本方法也不能简单套用；实矩阵存在复特征值情况，也不适用

#### 相似性
对于一步计算：
$$A_{k+1}=R_kQ_k=Q_k^{-1}Q_kR_kQ_k=Q_k^{-1}A_kQ_k$$

因此每一步，都是基于正交矩阵 $Q_k$ 进行相似变换，因此特征值不变

#### 趋向上三角矩阵
对于从 $A_0$ 出发，进行相似变换到第 k 次时：
$$A_k=Q_{k-1}^{-1}\cdots Q_{0}^{-1}A_0Q_0\cdots Q_{k-1}$$

可以整理为：
$$A_k=(Q_0Q_1\cdots Q_{k-1})^{-1}A_0(Q_0Q_1\cdots Q_{k-1})$$

考虑对 $A_0^k$ 进行 QR分解，例如 $k=3$ 时：
$$\begin{aligned}
A_0^3&=(Q_0R_0)(Q_0R_0)(Q_0R_0)\\
&=Q_0(R_0Q_0)(R_0Q_0)R_0\\
&=Q_0(Q_1R_1)(Q_1R_1)R_0\\
&=Q_0Q_1(A_2)R_1R_0\\
&=(Q_0Q_1Q_2)(R_2R_1R_0)
\end{aligned}$$

正交矩阵乘积依然是正交矩阵，上三角矩阵乘积仍然是上三角矩阵，所以可以得到：
$$Q_0Q_1\cdots Q_{k-1}\ 正是\ A_0^k\ 的\ QR\ 分解正交矩阵$$

又由于 $A_0^kI=Q(k)R(k)\Rightarrow Q(k)=Q_0Q_1\cdots Q_{k-1}$

则 QR 方法中的第 k 步出现的 $A_k$，实际上与以单位矩阵为初始矩阵的幂法的第 k 步得到的矩阵一致，因此也是趋向上三角矩阵

### Hessenberg矩阵
实际使用 QR 方法时，会先进行相似变化，得到 Hessenberg 矩阵的形式，如下：
$$\begin{pmatrix}
*&*&*&*&*\\
*&*&*&*&*\\
0&*&*&*&*\\
0&0&*&*&*\\
0&0&0&*&*\\
\end{pmatrix}$$

即在上三角矩阵基础上，对角线左下方一条斜线也不为零

可以推导，Hessenberg 矩阵在进行 QR迭代之后，仍然能保持 Hessenberg 形式，从而减少计算量（证明略）

### Householder方法
Householder 方法可以将一般的非对称矩阵通过相似变换约化为 Hessenberg 矩阵

**镜像变换**指把空间中任意一点，变换到经过原点的某一超平面对称的另一点

令“经过原点的超平面”的单位法向量为 $\boldsymbol{u}$，那么 $\boldsymbol{u}\boldsymbol{u}^T$ 为把任意向量正投影到单位法向量所在直线上的线性变换

则镜像变换公式为：
$$\boldsymbol{x}'=(I-2\boldsymbol{u}\boldsymbol{u}^T)\boldsymbol{x}$$

镜像变换的矩阵为： $H=I-2\boldsymbol{u}\boldsymbol{u}^T$，（证明略）它为对称矩阵、正交阵

**例子**：尝试把一个 4×4 矩阵变换为 Hessenberg 矩阵

给定两个向量 $\boldsymbol{x},\boldsymbol{y}$，它们模长一致，考虑以 $\boldsymbol{x}-\boldsymbol{y}$ 为法向量的超平面，则其镜像变换为：
$$H=I-2\boldsymbol{u}\boldsymbol{u}^T,\quad \boldsymbol{u}=\frac{\boldsymbol{x}-\boldsymbol{y}}{\|\boldsymbol{x}-\boldsymbol{y}\|}$$

$$H\boldsymbol{x}=\boldsymbol{y},\quad H\boldsymbol{y}=\boldsymbol{x}$$

对于其中的 $\boldsymbol{x}$ 无限制，但特别设置 $\boldsymbol{y}$ 除了第1分量之外均为0，可以设为：
$$\boldsymbol{y}=(|\boldsymbol{x}|,0,0)^T$$

则该映射 H 为从 $\boldsymbol{x}=(x,y,z)^T$ 到 $\boldsymbol{y}=(\|\boldsymbol{x}\|,0,0)^T$

$$\left(\begin{array}{c|ccc}
1&0&0&0\\\hline 0\\0&&H\\0\\
\end{array}\right)
\begin{pmatrix}*&*&*&*\\x&*&*&*\\y&*&*&*\\z&*&*&*\end{pmatrix}=
\begin{pmatrix}*&*&*&*\\\|\boldsymbol{x}\|&*&*&*\\0&*&*&*\\0&*&*&*\end{pmatrix}$$

根据对应位置的 x,y,z 生成对应的镜像变换矩阵 H，随后执行如上变换，随后再右乘相同矩阵

$$\begin{pmatrix}*&*&*&*\\\|\boldsymbol{x}\|&*&*&*\\0&*&*&*\\0&*&*&*\end{pmatrix}
\left(\begin{array}{c|ccc}
1&0&0&0\\\hline 0\\0&&H\\0\\
\end{array}\right)=
\begin{pmatrix}*&*&*&*\\\|\boldsymbol{x}\|&*&*&*\\0&*&*&*\\0&*&*&*\end{pmatrix}$$

则通过这次相似变换，完成了第一列的 Hessenberg 化

后续迭代，直到变成 Hessenberg 矩阵

### Hessenberg矩阵的QR迭代
仍然以 4×4 矩阵为例，执行左乘旋转矩阵变换，做到相应位置 $a'_{pq}=0$：
$$A_k=\begin{pmatrix}*&*&*&*\\*&*&*&*\\0&*&*&*\\0&0&*&*\end{pmatrix} \Rightarrow R(\theta_1,1,2)^TA_k=\begin{pmatrix}*&*&*&*\\\boxed{0}&*&*&*\\0&*&*&*\\0&0&*&*\end{pmatrix}$$

$$R(\theta_2,2,3)^TR(\theta_1,1,2)^TA_k=\begin{pmatrix}*&*&*&*\\0&*&*&*\\0&\boxed{0}&*&*\\0&0&*&*\end{pmatrix}$$

$$R(\theta_3,3,4)^TR(\theta_2,2,3)^TR(\theta_1,1,2)^TA_k=\begin{pmatrix}*&*&*&*\\0&*&*&*\\0&0&*&*\\0&0&\boxed{0}&*\end{pmatrix}=R$$

则完成 QR 分解：
$$R=R(\theta_3,3,4)^TR(\theta_2,2,3)^TR(\theta_1,1,2)^TA_k\\
Q=R(\theta_1,1,2)R(\theta_2,2,3)R(\theta_3,3,4)$$

### 原点位移、降阶
实际中，通常会先想办法得到一个特征值的估计值 $\hat{\lambda}$，然后用 $A-\hat\lambda I$ 来代替 $A$ 进行 QR 迭代，称之为**原点位移**

在迭代过程中，第 n 行的非对角元素将加速趋近于 0（公式中的 $\boxed{0}$），从而尽早获得一个特征值 $\blacksquare$：
$$\begin{pmatrix}
*&*&*&*\\
*&*&*&*\\
0&*&*&*\\
0&0&\boxed{0}&\blacksquare
\end{pmatrix}$$

从而可以将第 n 列和第 n 行去除，获得一个 n-1 维方阵，继续计算，迭代下去

### 对称矩阵的情况
对一般的对称矩阵使用 Householder 变换，可以得到对称的 Hessenberg 矩阵，也就是**三对角矩阵**：
$$\begin{pmatrix}
*&*&0&\cdots&0\\
*&*&*&\ddots&\vdots\\
0&*&*&\ddots&0\\
\vdots&\ddots&\ddots&\ddots&*\\
0&\cdots&0&*&*\\
\end{pmatrix}$$

后续 QR 迭代，将不断趋近于对角矩阵

### 反幂法（反迭代法）
对于矩阵 A 的某一个特征值 $\lambda_k$，假设现在得到一个精度一般的近似值 $\hat\lambda_k$

则矩阵 $A-\hat\lambda_k I$ 会有一个很小的特征值 $\lambda_k-\hat\lambda_k$，则采用幂法求绝对值最小的特征值的算法，从而得到修正值，从而提高精度
